{"file":"signup.vue2.mjs","mappings":";;;;;;;;;AA6Ee,sBAAkB;AAC3B,UAAA,QAAQ,IAAI,EAAE;AACd,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,kBAAkB,IAAI,EAAE;AACxB,UAAA,UAAU,IAAI,EAAE;AAChB,UAAA,UAAU,IAAI,KAAK;AACnB,UAAA,UAAU,IAAI,KAAK;AAGzB,UAAM,mBAAmB,SAAS;AAAA,MAChC,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,WAAW;AAAA,MACX,QAAQ;AAAA,MACR,QAAQ;AAAA,IAAA,CACT;AAaK,UAAA,mBAAmB,SAAS,MAAM;AACtC,aAAO,OAAO,OAAO,gBAAgB,EAAE,MAAM,OAAO;AAAA,IAAA,CACrD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/signup.vue"],"sourcesContent":["<template>\r\n  <div class=\"flex items-center justify-center min-h-[calc(100vh-200px)] py-12 px-4 sm:px-6 lg:px-8\">\r\n    <div class=\"w-full max-w-md space-y-8 bg-white p-8 md:p-10 rounded-lg shadow border border-cream-gray\">\r\n      <div>\r\n        <h2 class=\"mt-6 text-center text-3xl font-bold tracking-tight text-brown-dark\">\r\n          إنشاء حساب جديد\r\n        </h2>\r\n      </div>\r\n      <form class=\"mt-8 space-y-6\" @submit.prevent=\"handleSignup\">\r\n        <!-- رسائل الخطأ أو النجاح -->\r\n        <div v-if=\"message\" :class=\"isError ? 'text-red-600' : 'text-green-600'\" class=\"text-center text-sm mb-4 p-2 bg-opacity-10 rounded\" :style=\"{ backgroundColor: isError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(34, 197, 94, 0.1)' }\">\r\n          {{ message }}\r\n        </div>\r\n\r\n        <!-- استخدام flex-col لترتيب الحقول فوق بعضها بشكل واضح -->\r\n        <div class=\"flex flex-col gap-y-4\">\r\n          <div>\r\n            <label for=\"full-name\" class=\"block text-sm font-medium text-brown-dark mb-1\">الاسم الكامل</label>\r\n            <input id=\"full-name\" name=\"full-name\" type=\"text\" v-model=\"fullName\" required\r\n                   class=\"relative block w-full appearance-none rounded-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm\"\r\n                   placeholder=\"أدخل اسمك الكامل\">\r\n          </div>\r\n          <div>\r\n            <label for=\"email-address\" class=\"block text-sm font-medium text-brown-dark mb-1\">البريد الإلكتروني</label>\r\n            <input id=\"email-address\" name=\"email\" type=\"email\" v-model=\"email\" autocomplete=\"email\" required\r\n                   class=\"relative block w-full appearance-none rounded-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm\"\r\n                   placeholder=\"أدخل بريدك الإلكتروني\">\r\n          </div>\r\n          <div>\r\n            <label for=\"password\" class=\"block text-sm font-medium text-brown-dark mb-1\">كلمة المرور</label>\r\n            <input id=\"password\" name=\"password\" type=\"password\" v-model=\"password\" autocomplete=\"new-password\" required\r\n                   @input=\"validatePasswordStrength\" \r\n                   class=\"relative block w-full appearance-none rounded-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm\"\r\n                   placeholder=\"أنشئ كلمة مرور قوية\">\r\n             <!-- إرشادات كلمة المرور -->\r\n             <ul class=\"mt-2 text-xs text-gray-500 list-disc list-inside space-y-1\">\r\n                <li :class=\"{'text-green-600': passwordCriteria.length}\">8 حروف على الأقل</li>\r\n                <li :class=\"{'text-green-600': passwordCriteria.uppercase}\">حرف كبير واحد على الأقل</li>\r\n                <li :class=\"{'text-green-600': passwordCriteria.lowercase}\">حرف صغير واحد على الأقل</li>\r\n                <li :class=\"{'text-green-600': passwordCriteria.number}\">رقم واحد على الأقل</li>\r\n                <li :class=\"{'text-green-600': passwordCriteria.symbol}\">رمز واحد على الأقل (مثل @$!%*?&)</li>\r\n             </ul>\r\n          </div>\r\n          <div>\r\n            <label for=\"confirm-password\" class=\"block text-sm font-medium text-brown-dark mb-1\">تأكيد كلمة المرور</label>\r\n            <input id=\"confirm-password\" name=\"confirm-password\" type=\"password\" v-model=\"confirmPassword\" autocomplete=\"new-password\" required\r\n                   class=\"relative block w-full appearance-none rounded-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm\"\r\n                   placeholder=\"أعد كتابة كلمة المرور\">\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <button type=\"submit\" :disabled=\"loading || !isPasswordStrong\" \r\n                  class=\"group relative flex w-full justify-center rounded-md border border-transparent bg-olive-green py-2 px-4 text-sm font-medium text-white hover:bg-opacity-85 focus:outline-none focus:ring-2 focus:ring-olive-green focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\">\r\n            <span v-if=\"loading\" class=\"absolute inset-y-0 left-0 flex items-center pl-3\">\r\n              <svg class=\"animate-spin h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n              </svg>\r\n            </span>\r\n            <span :class=\"{ 'opacity-0': loading }\">إنشاء الحساب</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"text-sm text-center\">\r\n          <NuxtLink to=\"/login\" class=\"font-medium text-olive-green hover:underline\">\r\n            لديك حساب بالفعل؟ تسجيل الدخول\r\n          </NuxtLink>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed } from 'vue' // استيراد reactive و computed\r\nimport { useSupabaseClient, navigateTo } from '#imports'\r\n\r\nconst client = useSupabaseClient()\r\nconst email = ref('')\r\nconst password = ref('')\r\nconst fullName = ref('')\r\nconst confirmPassword = ref('') // إضافة حقل تأكيد كلمة المرور\r\nconst message = ref('')\r\nconst isError = ref(false)\r\nconst loading = ref(false)\r\n\r\n// حالة لتتبع معايير قوة كلمة المرور\r\nconst passwordCriteria = reactive({\r\n  length: false,\r\n  uppercase: false,\r\n  lowercase: false,\r\n  number: false,\r\n  symbol: false\r\n})\r\n\r\n// دالة للتحقق من قوة كلمة المرور وتحديث الحالة\r\nconst validatePasswordStrength = () => {\r\n  const pass = password.value\r\n  passwordCriteria.length = pass.length >= 8\r\n  passwordCriteria.uppercase = /[A-Z]/.test(pass)\r\n  passwordCriteria.lowercase = /[a-z]/.test(pass)\r\n  passwordCriteria.number = /[0-9]/.test(pass)\r\n  passwordCriteria.symbol = /[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]+/.test(pass) // يمكنك تعديل مجموعة الرموز\r\n}\r\n\r\n// خاصية محسوبة لمعرفة ما إذا كانت جميع المعايير متحققة\r\nconst isPasswordStrong = computed(() => {\r\n  return Object.values(passwordCriteria).every(Boolean)\r\n})\r\n\r\nconst handleSignup = async () => {\r\n  // التحقق من تطابق كلمتي المرور\r\n  if (password.value !== confirmPassword.value) {\r\n    message.value = 'كلمتا المرور غير متطابقتين.'\r\n    isError.value = true\r\n    return // إيقاف التنفيذ\r\n  }\r\n\r\n  // التحقق من قوة كلمة المرور قبل الإرسال (إجراء إضافي)\r\n  if (!isPasswordStrong.value) {\r\n     message.value = 'الرجاء التأكد من أن كلمة المرور تحقق جميع المعايير المطلوبة.'\r\n     isError.value = true\r\n     return\r\n  }\r\n\r\n  loading.value = true\r\n  message.value = ''\r\n  isError.value = false\r\n\r\n  const { data, error } = await client.auth.signUp({\r\n    email: email.value,\r\n    password: password.value, // استخدم كلمة المرور بعد التحقق\r\n    options: {\r\n      data: {\r\n        full_name: fullName.value, // الاسم أصبح مطلوبًا في الواجهة\r\n      }\r\n    }\r\n  })\r\n\r\n  loading.value = false\r\n\r\n  // بقية منطق التعامل مع الاستجابة يبقى كما هو...\r\n  if (error) {\r\n    console.error('Signup Error:', error.message)\r\n    // تحسين رسالة الخطأ الخاصة بضعف كلمة المرور إذا أرسلها Supabase\r\n    if (error.message.includes('password should be at least')) {\r\n         message.value = 'كلمة المرور ضعيفة جدًا. يرجى اتباع الإرشادات.'\r\n    } else {\r\n        message.value = error.message || 'حدث خطأ أثناء إنشاء الحساب.'\r\n    }\r\n    isError.value = true\r\n  } else if (data.user) {\r\n      if (data.user.identities && data.user.identities.length === 0) {\r\n         message.value = 'تم إرسال رابط التأكيد إلى بريدك الإلكتروني. يرجى التحقق منه لتفعيل حسابك.';\r\n         isError.value = false;\r\n      } else if (data.session) {\r\n          message.value = 'تم إنشاء الحساب وتسجيل الدخول بنجاح!';\r\n          isError.value = false;\r\n          setTimeout(() => navigateTo('/profile'), 1500);\r\n      } else {\r\n        message.value = 'تم إنشاء الحساب بنجاح. قد تحتاج لتأكيد بريدك الإلكتروني.';\r\n         isError.value = false;\r\n          // توجيه المستخدم لصفحة التأكيد بعد لحظة لعرض الرسالة\r\n      setTimeout(() => navigateTo('/confirm?email=' + encodeURIComponent(email.value)), 2000);\r\n      }\r\n  } else {\r\n    message.value = 'حدث خطأ غير متوقع.';\r\n    isError.value = true;\r\n       // توجيه المستخدم لصفحة التأكيد هنا أيضًا\r\n    setTimeout(() => navigateTo('/confirm?email=' + encodeURIComponent(email.value)), 2000);\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n/* تغيير لون الإرشادات المتحققة */\r\nli.text-green-600 {\r\n    color: #16a34a; /* يمكنك استخدام كلاس Tailwind text-green-600 مباشرة إذا كان يعمل */\r\n}\r\nbutton:disabled span:first-child {\r\n    left: 0.75rem;\r\n}\r\n</style>"],"version":3}