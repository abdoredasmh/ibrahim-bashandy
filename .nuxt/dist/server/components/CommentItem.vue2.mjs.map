{"version":3,"file":"CommentItem.vue2.mjs","sources":["../../../../components/CommentItem.vue"],"sourcesContent":["<template>\r\n  <div class=\"py-4\">\r\n    <!-- التعليق الأصلي -->\r\n    <div class=\"flex space-x-3 rtl:space-x-reverse\">\r\n      <UserAvatar\r\n        :avatar-url=\"comment.profiles?.avatar_url\"\r\n        :name=\"comment.profiles?.full_name\"\r\n        size=\"md\"\r\n        class=\"mt-1\"\r\n      />\r\n      <div class=\"flex-1 min-w-0\">\r\n        <div class=\"flex items-center justify-between gap-2\">\r\n          <span class=\"text-sm font-semibold text-gray-900 dark:text-white truncate\">\r\n            {{ comment.profiles?.full_name || 'مستخدم' }}\r\n          </span>\r\n          <CommentActions\r\n            :item=\"comment\"\r\n            item-type=\"comment\"\r\n            :is-commenting-suspended=\"isCommentingSuspended\" \r\n            @reply=\"toggleReplyForm\"\r\n            @edit=\"startEditingComment\"\r\n            @delete=\"requestDeleteComment\"\r\n            class=\"flex-shrink-0\"\r\n          />\r\n        </div>\r\n        <div class=\"text-xs text-gray-500 dark:text-gray-400 mb-1\">\r\n          <time :datetime=\"comment.created_at\" :title=\"fullTimestamp\">{{ formattedTimestamp }}</time>\r\n          <span v-if=\"isCommentEdited\" class=\"mx-1\" title=\"تم تعديل هذا التعليق\">(تم التعديل)</span>\r\n        </div>\r\n\r\n        <!-- عرض محتوى التعليق -->\r\n        <p v-if=\"!isEditingComment\" class=\"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words\">\r\n          {{ comment.content }}\r\n        </p>\r\n\r\n        <!-- وضع تعديل التعليق -->\r\n        <div v-else>\r\n          <textarea\r\n            ref=\"editCommentInputRef\"\r\n            v-model=\"editedCommentContent\"\r\n            rows=\"3\"\r\n            class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70\"\r\n            placeholder=\"تعديل التعليق...\"\r\n            :disabled=\"isSavingCommentEdit\"\r\n            @keydown.esc=\"cancelEditComment\"\r\n            @keydown.enter.prevent.exact=\"saveEditComment\"\r\n             aria-label=\"تعديل التعليق\"\r\n          ></textarea>\r\n          <div class=\"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse\">\r\n            <span v-if=\"editCommentError\" class=\"text-xs text-red-500 flex-1 text-right\">{{ editCommentError }}</span>\r\n            <button @click=\"cancelEditComment\" type=\"button\" :disabled=\"isSavingCommentEdit\" class=\"px-3 py-1 text-xs ...\">إلغاء</button>\r\n            <button @click=\"saveEditComment\" type=\"button\" :disabled=\"isSavingCommentEdit || !editedCommentContent.trim()\" class=\"inline-flex ...\">\r\n               <svg v-if=\"isSavingCommentEdit\" class=\"animate-spin ...\"></svg>\r\n              <span>{{ isSavingCommentEdit ? 'جاري الحفظ...' : 'حفظ' }}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- أزرار الرد وعرض الردود (لغير وضع التعديل) -->\r\n        <div v-if=\"!isEditingComment\" class=\"mt-2 flex items-center space-x-4 rtl:space-x-reverse text-xs\">\r\n          <button\r\n            v-if=\"user\"\r\n            @click=\"toggleReplyForm\"\r\n            type=\"button\"\r\n            class=\"font-medium text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white inline-flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n             :disabled=\"isCommentingSuspended\" \r\n            aria-controls=\"reply-form-{{ comment.id }}\"\r\n            :aria-expanded=\"showReplyForm.toString()\"\r\n          >\r\n             <svg v-if=\"!showReplyForm\" xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M7.707 3.293a1 1 0 010 1.414L5.414 7H11a7 7 0 017 7v2a1 1 0 11-2 0v-2a5 5 0 00-5-5H5.414l2.293 2.293a1 1 0 11-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /></svg>\r\n             <svg v-else xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" /></svg>\r\n            <span>{{ showReplyForm ? 'إلغاء الرد' : (isCommentingSuspended ? 'الرد موقوف' : 'رد') }}</span> \r\n          </button>\r\n           <!-- Optional: Show suspension reason near reply button -->\r\n           <span v-if=\"isCommentingSuspended && user\" class=\"text-yellow-600 dark:text-yellow-400\">(لا يمكنك الرد حاليًا)</span>\r\n\r\n          <button\r\n            v-if=\"localReplies.length > 0\"\r\n            @click=\"repliesVisible = !repliesVisible\"\r\n            type=\"button\"\r\n            class=\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white flex items-center gap-1\"\r\n            :aria-expanded=\"repliesVisible.toString()\"\r\n            aria-controls=\"replies-list-{{ comment.id }}\"\r\n          >\r\n             <svg v-if=\"repliesVisible\" xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z\" clip-rule=\"evenodd\" /></svg>\r\n             <svg v-else xmlns=\"http://www.w3.org/2000/svg\" class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clip-rule=\"evenodd\" /></svg>\r\n            <span>\r\n                {{ localReplies.length }} {{ localReplies.length === 1 ? 'رد' : (localReplies.length === 2 ? 'ردان' : (localReplies.length <= 10 ? 'ردود' : 'ردًا')) }}\r\n            </span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- منطقة الردود -->\r\n    <div class=\"mt-3 ml-10 rtl:mr-10 rtl:ml-0 pl-3 rtl:pr-3 border-l-2 border-gray-200 dark:border-gray-700 rtl:border-l-0 rtl:border-r-2\">\r\n      <!-- نموذج إضافة رد جديد -->\r\n      <div v-if=\"showReplyForm\" :id=\"'reply-form-' + comment.id\" class=\"mb-4\">\r\n        <div class=\"flex space-x-3 rtl:space-x-reverse\">\r\n          <UserAvatar :avatar-url=\"userProfile?.avatar_url\" :name=\"userProfile?.full_name\" size=\"sm\" class=\"mt-1\"/>\r\n          <div class=\"flex-1 min-w-0\">\r\n            <textarea\r\n              ref=\"replyInputRef\"\r\n              v-model=\"newReplyContent\"\r\n              rows=\"2\"\r\n              class=\"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70\"\r\n              placeholder=\"إضافة رد عام...\"\r\n               :disabled=\"isSubmittingReply || isCommentingSuspended\" \r\n              @keydown.esc=\"cancelReply\"\r\n              @keydown.enter.prevent.exact=\"addReply\"\r\n              aria-label=\"إضافة رد جديد\"\r\n            ></textarea>\r\n             <!-- Suspension Message for reply form -->\r\n             <p v-if=\"isCommentingSuspended\" class=\"mt-1 text-xs text-yellow-600 dark:text-yellow-400\">\r\n               لا يمكنك إضافة رد حاليًا بسبب الإيقاف.\r\n             </p>\r\n            <div class=\"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse\">\r\n              <span v-if=\"replyError\" class=\"text-xs text-red-500 flex-1 text-right\">{{ replyError }}</span>\r\n               <button @click=\"cancelReply\" type=\"button\" :disabled=\"isSubmittingReply\" class=\"px-3 py-1 text-xs ...\">إلغاء</button>\r\n              <button\r\n                @click=\"addReply\"\r\n                type=\"button\"\r\n                :disabled=\"isSubmittingReply || !newReplyContent.trim() || isCommentingSuspended\" \r\n                class=\"inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-white bg-primary-600 border border-transparent rounded-md shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\"\r\n              >\r\n                <svg v-if=\"isSubmittingReply\" class=\"animate-spin ...\"></svg>\r\n                <span>{{ isSubmittingReply ? 'جاري الرد...' : 'رد' }}</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- قائمة الردود -->\r\n      <Transition name=\"fade\">\r\n        <div v-show=\"localReplies.length > 0 && repliesVisible\" :id=\"'replies-list-' + comment.id\" class=\"space-y-0\">\r\n          <ReplyItem\r\n            v-for=\"reply in sortedReplies\"\r\n            :key=\"reply.id\"\r\n            :reply=\"reply\"\r\n            @reply-updated=\"handleReplyUpdate\"\r\n            @reply-deleted=\"handleReplyDelete\"\r\n          />\r\n        </div>\r\n      </Transition>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch, nextTick, type PropType } from 'vue' // Added PropType\r\nimport type { Database } from '~/types/database.types'\r\nimport { formatDistanceToNowStrict } from 'date-fns'\r\nimport { ar } from 'date-fns/locale'\r\nimport UserAvatar from './UserAvatar.vue'\r\nimport ReplyItem from './ReplyItem.vue'\r\nimport CommentActions from './CommentActions.vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport { useUserStore } from '~/stores/user'\r\nimport type { PostgrestError } from '@supabase/supabase-js';\r\n\r\n// Define Type for Comment/Reply with Profile\r\ntype CommentWithProfile = Database['public']['Tables']['comments']['Row'] & {\r\n  profiles: Pick<Database['public']['Tables']['profiles']['Row'], 'id' | 'full_name' | 'avatar_url'> | null\r\n}\r\n\r\n// Define Content ID structure for associating replies\r\ntype ContentId = {\r\n  lesson_id?: number | string;\r\n  book_id?: number | string;\r\n  study_course_id?: number | string; // Ensure column name matches DB\r\n}\r\n\r\n// Props definition - ADD isCommentingSuspended\r\nconst props = defineProps({\r\n  comment: {\r\n      type: Object as PropType<CommentWithProfile>,\r\n      required: true\r\n  },\r\n  replies: {\r\n      type: Array as PropType<CommentWithProfile[]>,\r\n      default: () => []\r\n  },\r\n  contentId: {\r\n      type: Object as PropType<ContentId>,\r\n      required: true\r\n  },\r\n  isCommentingSuspended: { // Receive suspension status from parent\r\n      type: Boolean,\r\n      default: false\r\n  }\r\n})\r\n\r\n// Emits definition\r\nconst emit = defineEmits<{\r\n  (e: 'commentUpdated', updatedComment: CommentWithProfile): void\r\n  (e: 'commentDeleted', deletedCommentId: number): void\r\n  (e: 'replyAdded', newReply: CommentWithProfile): void\r\n}>()\r\n\r\n// Supabase & User context\r\nconst supabase = useSupabaseClient<Database>()\r\nconst user = useSupabaseUser()\r\nconst { profile: userProfile } = storeToRefs(useUserStore())\r\n\r\n// --- Component State ---\r\nconst localReplies = ref<CommentWithProfile[]>([])\r\nconst repliesVisible = ref(true)\r\nconst isEditingComment = ref(false)\r\nconst editedCommentContent = ref('')\r\nconst isSavingCommentEdit = ref(false)\r\nconst editCommentError = ref<string | null>(null)\r\nconst editCommentInputRef = ref<HTMLTextAreaElement | null>(null);\r\nconst showReplyForm = ref(false)\r\nconst newReplyContent = ref('')\r\nconst isSubmittingReply = ref(false)\r\nconst replyError = ref<string | null>(null)\r\nconst replyInputRef = ref<HTMLTextAreaElement | null>(null);\r\n\r\n// --- Computed Properties ---\r\nconst isOwner = computed(() => user.value && user.value.id === props.comment.user_id) // Renamed for clarity\r\nconst isCommentEdited = computed(() => props.comment.created_at !== props.comment.updated_at)\r\nconst formattedTimestamp = computed(() => { /* ... as before ... */\r\n   try { return formatDistanceToNowStrict(new Date(props.comment.created_at), { addSuffix: true, locale: ar }) }\r\n   catch (e) { console.error(\"Error formatting date:\", e); return props.comment.created_at?.toString() }\r\n})\r\nconst fullTimestamp = computed(() => { /* ... as before ... */\r\n    try { return new Date(props.comment.created_at).toLocaleString('ar-EG', {dateStyle: 'long', timeStyle: 'short'}); }\r\n    catch { return props.comment.created_at?.toString(); }\r\n})\r\nconst sortedReplies = computed(() => { /* ... as before ... */\r\n    return [...localReplies.value].sort((a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime());\r\n})\r\n\r\n// --- Watchers ---\r\nwatch(() => props.replies, (newReplies) => { /* ... as before ... */\r\n    localReplies.value = [...newReplies];\r\n}, { deep: true, immediate: true });\r\n\r\n// --- Methods for Comment Editing ---\r\nconst startEditingComment = async () => { /* ... as before ... */\r\n  if (!isOwner.value) return\r\n  isEditingComment.value = true\r\n  editedCommentContent.value = props.comment.content\r\n  editCommentError.value = null\r\n  showReplyForm.value = false // Close reply form when editing comment\r\n  await nextTick();\r\n  editCommentInputRef.value?.focus();\r\n}\r\nconst cancelEditComment = () => { /* ... as before ... */\r\n  isEditingComment.value = false\r\n  editedCommentContent.value = ''\r\n  editCommentError.value = null\r\n}\r\nconst saveEditComment = async () => { /* ... as before ... */\r\n  if (!isOwner.value || !editedCommentContent.value.trim() || isSavingCommentEdit.value) return\r\n  const contentToSave = editedCommentContent.value.trim();\r\n  if (contentToSave === props.comment.content) { cancelEditComment(); return; }\r\n  isSavingCommentEdit.value = true; editCommentError.value = null\r\n  try {\r\n    const { data, error } = await supabase.from('comments').update({ content: contentToSave, updated_at: new Date().toISOString() }).eq('id', props.comment.id).select('id, content, updated_at').single()\r\n    if (error) throw error; if (!data) throw new Error('لم يتم إرجاع بيانات التعليق المحدث.');\r\n    emit('commentUpdated', { ...props.comment, content: data.content, updated_at: data.updated_at }); isEditingComment.value = false\r\n  } catch (err: any) { console.error('Error updating comment:', err); editCommentError.value = `فشل حفظ التعديل: (${(err as PostgrestError).message || 'خطأ غير معروف'})`\r\n  } finally { isSavingCommentEdit.value = false }\r\n}\r\n\r\n// --- Method for Comment Deletion ---\r\nconst requestDeleteComment = async () => { /* ... as before ... */\r\n   if (!isOwner.value) return\r\n   if (window.confirm('هل أنت متأكد من حذف هذا التعليق وكل ردوده؟')) {\r\n     try { const { error } = await supabase.from('comments').delete().eq('id', props.comment.id); if (error) throw error; emit('commentDeleted', props.comment.id) }\r\n     catch (err: any) { console.error('Error deleting comment:', err); alert(`فشل حذف التعليق: (${(err as PostgrestError).message || 'خطأ غير معروف'})`) }\r\n   }\r\n}\r\n\r\n// --- Methods for Replying ---\r\nconst toggleReplyForm = async () => { /* ... as before ... */\r\n    if(!user.value || props.isCommentingSuspended) return; // Prevent opening if suspended\r\n    showReplyForm.value = !showReplyForm.value\r\n    newReplyContent.value = ''\r\n    replyError.value = null\r\n    if (showReplyForm.value) { isEditingComment.value = false; await nextTick(); replyInputRef.value?.focus(); }\r\n}\r\nconst cancelReply = () => { /* ... as before ... */\r\n    showReplyForm.value = false; newReplyContent.value = ''; replyError.value = null;\r\n}\r\n// ADD SUSPENSION CHECK to addReply\r\nconst addReply = async () => {\r\n  // Add suspension check here as well\r\n  if (props.isCommentingSuspended) {\r\n      replyError.value = \"لا يمكنك إضافة رد حاليًا بسبب الإيقاف.\";\r\n      return;\r\n  }\r\n  if (!user.value || !userProfile.value || !newReplyContent.value.trim() || isSubmittingReply.value) return\r\n  if (!userProfile.value.id) { replyError.value = 'خطأ: لم يتم العثور على معرف الملف الشخصي.'; console.error('Profile ID missing'); return; }\r\n\r\n  isSubmittingReply.value = true; replyError.value = null\r\n  const replyData = { /* ... as before ... */\r\n    user_id: user.value.id, profile_id: userProfile.value.id, content: newReplyContent.value.trim(), parent_comment_id: props.comment.id,\r\n    ...(props.contentId.lesson_id && { lesson_id: Number(props.contentId.lesson_id) }),\r\n    ...(props.contentId.book_id && { book_id: Number(props.contentId.book_id) }),\r\n    ...(props.contentId.study_course_id && { study_course_id: Number(props.contentId.study_course_id) }),\r\n  };\r\n   if (!replyData.lesson_id && !replyData.book_id && !replyData.study_course_id) { replyError.value = 'خطأ: يجب ربط الرد بمحتوى.'; console.error('Content ID missing'); isSubmittingReply.value = false; return; }\r\n\r\n  try {\r\n    const { data: newReply, error } = await supabase.from('comments').insert(replyData).select(`*, profiles!inner (id, full_name, avatar_url)`).single()\r\n    if (error) throw error; if (!newReply || !newReply.profiles) throw new Error('فشل جلب بيانات الرد الجديد.');\r\n    emit('replyAdded', newReply as CommentWithProfile); newReplyContent.value = ''; showReplyForm.value = false; repliesVisible.value = true\r\n  } catch (err: any) { console.error('Error adding reply:', err); replyError.value = `فشل إضافة الرد: (${(err as PostgrestError).message || 'خطأ غير معروف'})`\r\n  } finally { isSubmittingReply.value = false }\r\n}\r\n\r\n// --- Methods to Handle Events from ReplyItem ---\r\nconst handleReplyUpdate = (updatedReply: CommentWithProfile) => { /* ... as before ... */\r\n  const index = localReplies.value.findIndex(r => r.id === updatedReply.id); if (index !== -1) { localReplies.value.splice(index, 1, updatedReply); }\r\n}\r\nconst handleReplyDelete = (deletedReplyId: number) => { /* ... as before ... */\r\n  localReplies.value = localReplies.value.filter(r => r.id !== deletedReplyId)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* ... (styles remain the same) ... */\r\n.fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }\r\n.fade-enter-from, .fade-leave-to { opacity: 0; }\r\n.fade-leave-active { position: absolute; visibility: hidden; }\r\n</style>"],"names":[],"mappings":"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"}