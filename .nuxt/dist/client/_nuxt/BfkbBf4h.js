import{_ as Ce}from"./CEyFpblA.js";import{_ as We}from"./CWN7cs2y.js";import{_ as ze}from"./C2nUyU-9.js";import{e as Ne,E as Fe,u as Ve,q as Xe,r as m,l as Ue,c as u,a as t,b as w,w as y,o as c,h as v,i as P,t as f,d as S,v as Z,x as I,y as O,F as ce,j as fe,B as Ie,n as Oe,_ as je}from"./CaF1xe-H.js";import{B as j}from"./In8HDdPU.js";import{L as ae}from"./CpjGp_h0.js";import{_ as Le}from"./Cjm1-dYk.js";import{u as me}from"./CqvecxAQ.js";import{n as se,c as te,g as Ae,a as Re,e as Ye,b as ve,d as $e,f as oe,h as $,i as B,j as Be}from"./Bqepao4b.js";import{t as q,m as ge,a as ee}from"./DhpZqJBn.js";function qe(i,n,r){const[l,o]=se(r==null?void 0:r.in,i,n),x=l.getFullYear()-o.getFullYear(),b=l.getMonth()-o.getMonth();return x*12+b}function He(i,n){return+q(i)-+q(n)}function Qe(i,n){const r=q(i);return r.setHours(23,59,59,999),r}function Ge(i,n){const r=q(i),l=r.getMonth();return r.setFullYear(r.getFullYear(),l+1,0),r.setHours(23,59,59,999),r}function Je(i,n){const r=q(i);return+Qe(r)==+Ge(r)}function Ke(i,n,r){const[l,o,x]=se(r==null?void 0:r.in,i,i,n),b=te(o,x),d=Math.abs(qe(o,x));if(d<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-b*d);let _=te(o,x)===-b;Je(l)&&d===1&&te(l,x)===1&&(_=!1);const E=b*(d-+_);return E===0?0:E}function Ze(i,n,r){const l=He(i,n)/1e3;return Ae(r==null?void 0:r.roundingMethod)(l)}function et(i,n,r){const l=Re(),o=(r==null?void 0:r.locale)??l.locale??Ye,x=2520,b=te(i,n);if(isNaN(b))throw new RangeError("Invalid time value");const d=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:b}),[_,E]=se(r==null?void 0:r.in,...b>0?[n,i]:[i,n]),k=Ze(E,_),N=(ve(E)-ve(_))/1e3,g=Math.round((k-N)/60);let M;if(g<2)return r!=null&&r.includeSeconds?k<5?o.formatDistance("lessThanXSeconds",5,d):k<10?o.formatDistance("lessThanXSeconds",10,d):k<20?o.formatDistance("lessThanXSeconds",20,d):k<40?o.formatDistance("halfAMinute",0,d):k<60?o.formatDistance("lessThanXMinutes",1,d):o.formatDistance("xMinutes",1,d):g===0?o.formatDistance("lessThanXMinutes",1,d):o.formatDistance("xMinutes",g,d);if(g<45)return o.formatDistance("xMinutes",g,d);if(g<90)return o.formatDistance("aboutXHours",1,d);if(g<ge){const h=Math.round(g/60);return o.formatDistance("aboutXHours",h,d)}else{if(g<x)return o.formatDistance("xDays",1,d);if(g<ee){const h=Math.round(g/ge);return o.formatDistance("xDays",h,d)}else if(g<ee*2)return M=Math.round(g/ee),o.formatDistance("aboutXMonths",M,d)}if(M=Ke(E,_),M<12){const h=Math.round(g/ee);return o.formatDistance("xMonths",h,d)}else{const h=M%12,z=Math.trunc(M/12);return h<3?o.formatDistance("aboutXYears",z,d):h<9?o.formatDistance("overXYears",z,d):o.formatDistance("almostXYears",z+1,d)}}function he(i,n){return et(i,$e(i),n)}const tt={lessThanXSeconds:{one:"أقل من ثانية واحدة",two:"أقل من ثانتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية واحدة",two:"ثانتين",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نصف دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقائق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة واحدة",two:"دقيقتين",threeToTen:"{{count}} دقائق",other:"{{count}} دقيقة"},aboutXHours:{one:"ساعة واحدة تقريباً",two:"ساعتين تقريباً",threeToTen:"{{count}} ساعات تقريباً",other:"{{count}} ساعة تقريباً"},xHours:{one:"ساعة واحدة",two:"ساعتين",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم واحد",two:"يومين",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"أسبوع واحد تقريباً",two:"أسبوعين تقريباً",threeToTen:"{{count}} أسابيع تقريباً",other:"{{count}} أسبوع تقريباً"},xWeeks:{one:"أسبوع واحد",two:"أسبوعين",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوع"},aboutXMonths:{one:"شهر واحد تقريباً",two:"شهرين تقريباً",threeToTen:"{{count}} أشهر تقريباً",other:"{{count}} شهر تقريباً"},xMonths:{one:"شهر واحد",two:"شهرين",threeToTen:"{{count}} أشهر",other:"{{count}} شهر"},aboutXYears:{one:"عام واحد تقريباً",two:"عامين تقريباً",threeToTen:"{{count}} أعوام تقريباً",other:"{{count}} عام تقريباً"},xYears:{one:"عام واحد",two:"عامين",threeToTen:"{{count}} أعوام",other:"{{count}} عام"},overXYears:{one:"أكثر من عام",two:"أكثر من عامين",threeToTen:"أكثر من {{count}} أعوام",other:"أكثر من {{count}} عام"},almostXYears:{one:"عام واحد تقريباً",two:"عامين تقريباً",threeToTen:"{{count}} أعوام تقريباً",other:"{{count}} عام تقريباً"}},rt=(i,n,r)=>{let l;const o=tt[i];return typeof o=="string"?l=o:n===1?l=o.one:n===2?l=o.two:n<=10?l=o.threeToTen.replace("{{count}}",String(n)):l=o.other.replace("{{count}}",String(n)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"في خلال "+l:"منذ "+l:l},at={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ot={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},st={full:"{{date}} 'عند' {{time}}",long:"{{date}} 'عند' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nt={date:oe({formats:at,defaultWidth:"full"}),time:oe({formats:ot,defaultWidth:"full"}),dateTime:oe({formats:st,defaultWidth:"full"})},lt={lastWeek:"'أخر' eeee 'عند' p",yesterday:"'أمس عند' p",today:"'اليوم عند' p",tomorrow:"'غداً عند' p",nextWeek:"eeee 'عند' p",other:"P"},it=(i,n,r,l)=>lt[i],dt={narrow:["ق","ب"],abbreviated:["ق.م.","ب.م."],wide:["قبل الميلاد","بعد الميلاد"]},ut={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},ct={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["ينا","فبر","مارس","أبريل","مايو","يونـ","يولـ","أغسـ","سبتـ","أكتـ","نوفـ","ديسـ"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},ft={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنـ","ثلا","أربـ","خميـ","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},mt={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"}},vt={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"في الصباح",afternoon:"بعد الظـهر",evening:"في المساء",night:"في الليل"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظـهر",evening:"في المساء",night:"في الليل"}},gt=i=>String(i),ht={ordinalNumber:gt,era:$({values:dt,defaultWidth:"wide"}),quarter:$({values:ut,defaultWidth:"wide",argumentCallback:i=>i-1}),month:$({values:ct,defaultWidth:"wide"}),day:$({values:ft,defaultWidth:"wide"}),dayPeriod:$({values:mt,defaultWidth:"wide",formattingValues:vt,defaultFormattingWidth:"wide"})},pt=/^(\d+)(th|st|nd|rd)?/i,yt=/\d+/i,bt={narrow:/^(ق|ب)/i,abbreviated:/^(ق\.?\s?م\.?|ق\.?\s?م\.?\s?|a\.?\s?d\.?|c\.?\s?)/i,wide:/^(قبل الميلاد|قبل الميلاد|بعد الميلاد|بعد الميلاد)/i},wt={any:[/^قبل/i,/^بعد/i]},xt={narrow:/^[1234]/i,abbreviated:/^ر[1234]/i,wide:/^الربع [1234]/i},_t={any:[/1/i,/2/i,/3/i,/4/i]},kt={narrow:/^[يفمأمسند]/i,abbreviated:/^(ين|ف|مار|أب|ماي|يون|يول|أغ|س|أك|ن|د)/i,wide:/^(ين|ف|مار|أب|ماي|يون|يول|أغ|س|أك|ن|د)/i},Mt={narrow:[/^ي/i,/^ف/i,/^م/i,/^أ/i,/^م/i,/^ي/i,/^ي/i,/^أ/i,/^س/i,/^أ/i,/^ن/i,/^د/i],any:[/^ين/i,/^ف/i,/^مار/i,/^أب/i,/^ماي/i,/^يون/i,/^يول/i,/^أغ/i,/^س/i,/^أك/i,/^ن/i,/^د/i]},Dt={narrow:/^[حنثرخجس]/i,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,abbreviated:/^(أحد|اثن|ثلا|أرب|خمي|جمعة|سبت)/i,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/i},Tt={narrow:[/^ح/i,/^ن/i,/^ث/i,/^ر/i,/^خ/i,/^ج/i,/^س/i],wide:[/^الأحد/i,/^الاثنين/i,/^الثلاثاء/i,/^الأربعاء/i,/^الخميس/i,/^الجمعة/i,/^السبت/i],any:[/^أح/i,/^اث/i,/^ث/i,/^أر/i,/^خ/i,/^ج/i,/^س/i]},Pt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},St={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Et={ordinalNumber:Be({matchPattern:pt,parsePattern:yt,valueCallback:i=>parseInt(i,10)}),era:B({matchPatterns:bt,defaultMatchWidth:"wide",parsePatterns:wt,defaultParseWidth:"any"}),quarter:B({matchPatterns:xt,defaultMatchWidth:"wide",parsePatterns:_t,defaultParseWidth:"any",valueCallback:i=>i+1}),month:B({matchPatterns:kt,defaultMatchWidth:"wide",parsePatterns:Mt,defaultParseWidth:"any"}),day:B({matchPatterns:Dt,defaultMatchWidth:"wide",parsePatterns:Tt,defaultParseWidth:"any"}),dayPeriod:B({matchPatterns:Pt,defaultMatchWidth:"any",parsePatterns:St,defaultParseWidth:"any"})},pe={code:"ar-SA",formatDistance:rt,formatLong:nt,formatRelative:it,localize:ht,match:Et,options:{weekStartsOn:0,firstWeekContainsDate:1}},Ct={class:"container mx-auto px-4 py-8"},Wt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-8"},zt={class:"md:col-span-1 space-y-6"},Nt={class:"flex flex-col items-center space-y-4"},Ft={class:"relative"},Vt=["disabled"],Xt=["disabled"],Ut={key:0,class:"text-sm text-gray-500"},It={key:1,class:"text-sm text-red-500"},Ot={class:"text-xl font-semibold text-center"},jt={class:"text-gray-600 dark:text-gray-400 text-center"},Lt={class:"text-gray-600 dark:text-gray-400 text-center"},At={class:"font-bold"},Rt={class:"text-sm text-gray-500 dark:text-gray-300 mt-2 text-center px-2"},Yt={class:"md:col-span-2 space-y-6"},$t=["disabled"],Bt={key:0,class:"text-sm text-red-500 mt-2"},qt={key:1,class:"text-sm text-green-500 mt-2"},Ht={class:"space-y-6"},Qt=["disabled"],Gt={key:0,class:"text-sm text-red-500 mt-2"},Jt={key:1,class:"text-sm text-green-500 mt-2"},Kt=["disabled"],Zt={key:0,class:"text-sm text-red-500 mt-2"},er={key:1,class:"text-sm text-green-500 mt-2"},tr={key:0,class:"flex justify-center p-4"},rr={key:1,class:"text-red-500 p-4"},ar={key:2,class:"text-gray-500 p-4 text-center"},or={key:3,class:"space-y-4"},sr={class:"flex-grow w-full"},nr={class:"font-semibold text-lg"},lr={class:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2"},ir={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mt-2"},dr={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ur={key:0,class:"flex justify-center p-4"},cr={key:1,class:"text-red-500 p-4"},fr={key:2,class:"text-gray-500 p-4 text-center"},mr={key:3,class:"space-y-6"},vr={class:"flex justify-between items-start mb-2"},gr={class:"font-semibold"},hr={class:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap"},pr={class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},yr={key:0,class:"mt-3 text-right"},br=["onClick","disabled"],wr={class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600"},xr={key:0},_r={class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},kr={class:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-right"},Mr={key:1},Dr=["onClick"],Tr=["onSubmit"],Pr={class:"flex justify-end space-x-2 space-x-reverse"},Sr=["disabled"],Er={key:0,class:"text-sm text-red-500 mt-1"},Cr={key:1,class:"text-center text-gray-500 dark:text-gray-400 py-10"},Wr={class:"flex justify-center items-center h-64"},zr=Ne({__name:"profile",setup(i){const n=Fe(),r=Ve(),l=Xe(),o=m(""),x=m(""),b=m(""),d=m(""),_=m(""),E=m(null),k=m(!1),N=m(null),g=m(null),M=m(!1),h=m(null),z=m(!1),F=m(null),L=m(null),H=m(!1),A=m(null),Q=m(null),R=m(!1),Y=m(null),V=m(""),G=m(!1),X=m(null),U=m(null),{data:re,pending:ye,error:ne,refresh:Nr}=me("myCourses",()=>$fetch("/api/my-courses"),{lazy:!0,server:!1}),{data:C,pending:be,error:le,refresh:ie}=me("privateMessages",async()=>{if(!l.value)return[];const{data:a,error:e}=await r.from("user_private_messages").select("*").eq("user_id",l.value.id).order("created_at",{ascending:!1});if(e)throw console.error("Error fetching private messages:",e),e;return a||[]},{lazy:!0,server:!1,watch:[l]});Ue(()=>n.profile,a=>{a&&(o.value=a.full_name||"",x.value=a.bio||"")},{immediate:!0});async function we(){if(!(!l.value||!n.profile)){k.value=!0,N.value=null,g.value=null;try{const a={id:l.value.id,full_name:o.value.trim()||null,bio:x.value.trim()||null,updated_at:new Date().toISOString()};if(a.full_name===n.profile.full_name&&delete a.full_name,a.bio===n.profile.bio&&delete a.bio,Object.keys(a).length<=2){g.value="لا توجد تغييرات لحفظها.",k.value=!1;return}const{error:e}=await r.from("profiles").upsert(a);if(e)throw e;await n.fetchProfile(),g.value="تم تحديث الملف الشخصي بنجاح!",setTimeout(()=>g.value=null,3e3)}catch(a){console.error("Error updating profile:",a),N.value=a.message||"فشل تحديث الملف الشخصي."}finally{k.value=!1}}}function xe(){var a;(a=E.value)==null||a.click()}async function _e(a){var J;const e=a.target;if(!e.files||e.files.length===0||!l.value)return;const p=e.files[0],D=(J=p.name.split(".").pop())==null?void 0:J.toLowerCase(),W=`${l.value.id}/avatar.${D}`;if(!D||!["png","jpg","jpeg","gif"].includes(D)){h.value="نوع الملف غير مدعوم.";return}if(p.size>2*1024*1024){h.value="حجم الملف كبير جدًا (الحد الأقصى 2 ميجابايت).";return}M.value=!0,h.value=null;try{const{error:T}=await r.storage.from("avatars").upload(W,p,{upsert:!0});if(T)throw T;const{data:K}=r.storage.from("avatars").getPublicUrl(W);if(!(K!=null&&K.publicUrl))throw new Error("لم يتم العثور على رابط الصورة.");const Ee=K.publicUrl,{error:ue}=await r.from("profiles").update({avatar_url:Ee,updated_at:new Date().toISOString()}).eq("id",l.value.id);if(ue)throw ue;await n.fetchProfile()}catch(T){console.error("Error uploading avatar:",T),h.value=T.message||"فشل رفع الصورة.",T.message.includes("Bucket not found")?h.value="خطأ إعداد: مخزن الصور غير موجود.":T.message.includes("mime type")&&(h.value="نوع الملف غير مسموح به.")}finally{M.value=!1,e&&(e.value="")}}async function ke(){if(!b.value||!d.value){F.value="يرجى إدخال كلمة المرور الحالية والجديدة.";return}if(d.value.length<6){F.value="كلمة المرور الجديدة يجب أن تكون 6 أحرف على الأقل.";return}z.value=!0,F.value=null,L.value=null;try{const{error:a}=await r.auth.updateUser({password:d.value});if(a)throw a.message.includes("password should be different")?new Error("كلمة المرور الجديدة يجب أن تكون مختلفة عن الحالية."):a;L.value="تم تغيير كلمة المرور بنجاح!",b.value="",d.value="",setTimeout(()=>L.value=null,3e3)}catch(a){console.error("Error changing password:",a),F.value=a.message||"فشل تغيير كلمة المرور."}finally{z.value=!1}}async function Me(){if(!_.value||!l.value||_.value===l.value.email){A.value="يرجى إدخال بريد إلكتروني جديد وصحيح.";return}H.value=!0,A.value=null,Q.value=null;try{const{error:a}=await r.auth.updateUser({email:_.value});if(a)throw a;Q.value="تم إرسال رابط التأكيد إلى بريدك الإلكتروني الجديد.",_.value=""}catch(a){console.error("Error changing email:",a),A.value=a.message||"فشل تغيير البريد الإلكتروني."}finally{H.value=!1}}async function De(a){var e;if(!(!l.value||R.value)){R.value=a;try{const{error:p}=await r.from("user_private_messages").update({is_read:!0}).match({id:a,user_id:l.value.id});if(p)throw p;const D=(e=C.value)==null?void 0:e.findIndex(W=>W.id===a);D!==void 0&&D!==-1&&C.value&&(C.value[D].is_read=!0),await ie()}catch(p){console.error("Error marking message as read:",p)}finally{R.value=!1}}}function Te(a){Y.value=a,V.value="",X.value=null,U.value=null}function de(){Y.value=null,V.value="",X.value=null,U.value=null}async function Pe(a,e){if(!l.value||!V.value.trim()){X.value=a,U.value="الرجاء كتابة نص الرد.";return}G.value=!0,X.value=null,U.value=null;try{const p={user_reply_text:V.value.trim(),user_replied_at:new Date().toISOString(),admin_read_reply:!1},{data:D,error:W}=await r.from("user_private_messages").update(p).match({id:a,user_id:l.value.id}).select().single();if(W)throw W;C.value&&D?C.value[e]={...C.value[e],...D}:await ie(),de()}catch(p){console.error("Error submitting reply:",p),X.value=a,U.value=p.message||"فشل إرسال الرد."}finally{G.value=!1}}async function Se(){await n.logout()}return(a,e)=>{const p=Ce,D=We,W=ze;return c(),u("div",Ct,[e[27]||(e[27]=t("h1",{class:"text-3xl font-bold mb-8 text-center text-[color:var(--color-brown-dark)] dark:text-[color:var(--color-beige-light)]"},"الملف الشخصي",-1)),w(W,null,{fallback:y(()=>[t("div",Wr,[w(ae)])]),default:y(()=>[v(n).profile?(c(),u("div",Wt,[t("div",zt,[w(j,null,{title:y(()=>e[6]||(e[6]=[S("المعلومات الشخصية")])),content:y(()=>[t("div",Nt,[t("div",Ft,[w(Le,{src:v(n).userAvatar||void 0,alt:v(n).displayName,size:"xl"},null,8,["src","alt"]),t("button",{onClick:xe,class:"absolute bottom-0 right-0 bg-[color:var(--color-olive-green)] text-white rounded-full p-1 hover:bg-opacity-80 transition duration-200","aria-label":"تغيير الصورة الرمزية",disabled:M.value},e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 8a3 3 0 100-6 3 3 0 000 6z","clip-rule":"evenodd"})],-1)]),8,Vt),t("input",{type:"file",ref_key:"fileInput",ref:E,onChange:_e,class:"hidden",accept:"image/png, image/jpeg, image/gif",disabled:M.value},null,40,Xt)]),M.value?(c(),u("div",Ut,"جارٍ رفع الصورة...")):P("",!0),h.value?(c(),u("div",It,f(h.value),1)):P("",!0),t("h2",Ot,f(v(n).displayName),1),t("p",jt,f(v(n).userEmail),1),t("p",Lt,[e[8]||(e[8]=S("النقاط: ")),t("span",At,f(v(n).userPoints),1)]),t("p",Rt,f(v(n).userBio||"لا توجد نبذة شخصية."),1)])]),_:1}),w(j,null,{title:y(()=>e[9]||(e[9]=[S("تسجيل الخروج")])),content:y(()=>[t("button",{onClick:Se,class:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-200"}," تسجيل الخروج ")]),_:1})]),t("div",Yt,[w(j,null,{title:y(()=>e[10]||(e[10]=[S("تعديل الملف الشخصي")])),content:y(()=>[t("form",{onSubmit:Z(we,["prevent"]),class:"space-y-4"},[t("div",null,[e[11]||(e[11]=t("label",{for:"fullName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"الاسم الكامل",-1)),I(t("input",{type:"text",id:"fullName","onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[color:var(--color-olive-green)] focus:ring focus:ring-[color:var(--color-olive-green)] focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[O,o.value]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"bio",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"نبذة شخصية",-1)),I(t("textarea",{id:"bio","onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[color:var(--color-olive-green)] focus:ring focus:ring-[color:var(--color-olive-green)] focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[O,x.value]])]),t("button",{type:"submit",disabled:k.value,class:"w-full bg-[color:var(--color-olive-green)] hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded transition duration-200 disabled:opacity-50"},f(k.value?"جارٍ الحفظ...":"حفظ التعديلات"),9,$t),N.value?(c(),u("p",Bt,f(N.value),1)):P("",!0),g.value?(c(),u("p",qt,f(g.value),1)):P("",!0)],32)]),_:1}),w(j,null,{title:y(()=>e[13]||(e[13]=[S("إعدادات الحساب")])),content:y(()=>[t("div",Ht,[t("form",{onSubmit:Z(ke,["prevent"]),class:"space-y-4 border-b dark:border-gray-700 pb-6"},[e[16]||(e[16]=t("h4",{class:"font-semibold"},"تغيير كلمة المرور",-1)),t("div",null,[e[14]||(e[14]=t("label",{for:"currentPassword",class:"block text-sm font-medium"},"كلمة المرور الحالية",-1)),I(t("input",{type:"password",id:"currentPassword","onUpdate:modelValue":e[2]||(e[2]=s=>b.value=s),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-gray-700 dark:border-gray-600"},null,512),[[O,b.value]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"newPassword",class:"block text-sm font-medium"},"كلمة المرور الجديدة",-1)),I(t("input",{type:"password",id:"newPassword","onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s),required:"",minlength:"6",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-gray-700 dark:border-gray-600"},null,512),[[O,d.value]])]),t("button",{type:"submit",disabled:z.value,class:"w-full bg-[color:var(--color-blue-muted)] hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded transition duration-200 disabled:opacity-50"},f(z.value?"جارٍ التغيير...":"تغيير كلمة المرور"),9,Qt),F.value?(c(),u("p",Gt,f(F.value),1)):P("",!0),L.value?(c(),u("p",Jt,f(L.value),1)):P("",!0)],32),t("form",{onSubmit:Z(Me,["prevent"]),class:"space-y-4"},[e[18]||(e[18]=t("h4",{class:"font-semibold"},"تغيير البريد الإلكتروني",-1)),t("div",null,[e[17]||(e[17]=t("label",{for:"newEmail",class:"block text-sm font-medium"},"البريد الإلكتروني الجديد",-1)),I(t("input",{type:"email",id:"newEmail","onUpdate:modelValue":e[4]||(e[4]=s=>_.value=s),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-gray-700 dark:border-gray-600"},null,512),[[O,_.value]])]),t("button",{type:"submit",disabled:H.value,class:"w-full bg-[color:var(--color-blue-muted)] hover:bg-opacity-80 text-white font-bold py-2 px-4 rounded transition duration-200 disabled:opacity-50"},f(H.value?"جارٍ التغيير...":"تغيير البريد الإلكتروني"),9,Kt),e[19]||(e[19]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},"سيتم إرسال رابط تأكيد إلى بريدك الإلكتروني الجديد.",-1)),A.value?(c(),u("p",Zt,f(A.value),1)):P("",!0),Q.value?(c(),u("p",er,f(Q.value),1)):P("",!0)],32)])]),_:1}),w(j,null,{title:y(()=>e[20]||(e[20]=[S("دوراتي المسجل بها")])),content:y(()=>[v(ye)?(c(),u("div",tr,[w(ae)])):v(ne)?(c(),u("div",rr,"حدث خطأ أثناء تحميل الدورات: "+f(v(ne).message),1)):!v(re)||v(re).length===0?(c(),u("div",ar,[e[22]||(e[22]=S("لم تسجل في أي دورات بعد. ")),w(p,{to:"/study",class:"text-[color:var(--color-olive-green)] hover:underline"},{default:y(()=>e[21]||(e[21]=[S("تصفح الدورات")])),_:1})])):(c(),u("div",or,[(c(!0),u(ce,null,fe(v(re),s=>(c(),u("div",{key:s.id,class:"border rounded-lg p-4 flex flex-col sm:flex-row items-center gap-4 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm"},[w(D,{src:s.image_url||"/images/placeholder-course.jpg",alt:"صورة الدورة",class:"w-full sm:w-24 h-24 object-cover rounded-md flex-shrink-0",width:"96",height:"96",loading:"lazy",format:"webp",placeholder:""},null,8,["src"]),t("div",sr,[t("h4",nr,f(s.title),1),t("p",lr,f(s.description),1),t("div",ir,[t("div",{class:"bg-[color:var(--color-olive-green)] h-2.5 rounded-full",style:Ie({width:s.progress+"%"})},null,4)]),t("p",dr,f(s.progress)+"% مكتمل",1)]),w(p,{to:s.last_accessed_lesson_id?`/study/courses/${s.id}/lessons/${s.last_accessed_lesson_id}`:`/study/courses/${s.id}`,class:"mt-2 sm:mt-0 flex-shrink-0 whitespace-nowrap inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-[color:var(--color-olive-green)] hover:bg-opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[color:var(--color-olive-green)] dark:focus:ring-offset-gray-800 transition"},{default:y(()=>[S(f(s.last_accessed_lesson_id?"استئناف التعلم":"عرض الدورة")+" ",1),e[23]||(e[23]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1))]),_:2},1032,["to"])]))),128))]))]),_:1}),w(j,null,{title:y(()=>e[24]||(e[24]=[S("الرسائل الواردة (ردود الشيخ)")])),content:y(()=>[v(be)?(c(),u("div",ur,[w(ae)])):v(le)?(c(),u("div",cr,"حدث خطأ أثناء تحميل الرسائل: "+f(v(le).message),1)):!v(C)||v(C).length===0?(c(),u("div",fr,"لا توجد رسائل واردة حاليًا.")):(c(),u("div",mr,[e[26]||(e[26]=S(" {/* Increased spacing */} ")),(c(!0),u(ce,null,fe(v(C),(s,J)=>(c(),u("div",{key:s.id,class:Oe(["border rounded-lg p-4 dark:border-gray-700 shadow-sm transition-colors duration-300",s.is_read?"bg-gray-50 dark:bg-gray-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"])},[t("div",vr,[t("h4",gr,f(s.title),1),t("span",hr,f(v(he)(new Date(s.created_at),{addSuffix:!0,locale:v(pe)})),1)]),t("p",pr,f(s.content),1),s.is_read?P("",!0):(c(),u("div",yr,[t("button",{onClick:T=>De(s.id),disabled:R.value===s.id,class:"text-xs text-[color:var(--color-blue-muted)] hover:underline disabled:opacity-50 disabled:cursor-not-allowed"},f(R.value===s.id?"جارٍ...":"تمييز كمقروءة"),9,br)])),t("div",wr,[s.user_reply_text?(c(),u("div",xr,[e[25]||(e[25]=t("p",{class:"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-1"},"ردك:",-1)),t("p",_r,f(s.user_reply_text),1),t("p",kr,f(s.user_replied_at?v(he)(new Date(s.user_replied_at),{addSuffix:!0,locale:v(pe)}):""),1)])):(c(),u("div",Mr,[!Y.value||Y.value!==s.id?(c(),u("button",{key:0,onClick:T=>Te(s.id),class:"text-sm text-[color:var(--color-olive-green)] hover:underline"}," الرد على الرسالة ",8,Dr)):P("",!0),Y.value===s.id?(c(),u("form",{key:1,onSubmit:Z(T=>Pe(s.id,J),["prevent"]),class:"mt-2 space-y-2"},[I(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=T=>V.value=T),rows:"3",required:"",placeholder:"اكتب ردك هنا...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[color:var(--color-olive-green)] focus:ring focus:ring-[color:var(--color-olive-green)] focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[O,V.value]]),t("div",Pr,[t("button",{type:"button",onClick:de,class:"px-3 py-1 text-sm rounded border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"},"إلغاء"),t("button",{type:"submit",disabled:G.value,class:"px-3 py-1 text-sm rounded bg-[color:var(--color-olive-green)] text-white hover:bg-opacity-80 disabled:opacity-50"},f(G.value?"جارٍ الإرسال...":"إرسال الرد"),9,Sr)]),X.value===s.id?(c(),u("p",Er,f(U.value),1)):P("",!0)],40,Tr)):P("",!0)]))])],2))),128))]))]),_:1})])])):(c(),u("div",Cr," لا يمكن عرض الملف الشخصي. يرجى التأكد من تسجيل الدخول والمحاولة مرة أخرى. "))]),_:1})])}}}),Yr=je(zr,[["__scopeId","data-v-c3c817cc"]]);export{Yr as default};
