const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CnXauPEG.js","./CaF1xe-H.js","./entry.DgcQJhFP.css","./CpjGp_h0.js","./LoadingSpinner.Dre-g5PP.css","./vWwLff75.js","./QuizCreateEditModal.B2a-9TCJ.css","./CH4oOQ9J.js","./Dfgt84Z7.js"])))=>i.map(i=>d[i]);
import{e as W,u as X,N as H,r as l,k as J,c as a,a as t,i as _,b as f,d as b,t as n,n as N,F as K,j as Y,W as Q,X as S,o as r,w as q,_ as ee}from"./CaF1xe-H.js";import{_ as te}from"./CEyFpblA.js";import{L as se}from"./CpjGp_h0.js";const oe=Q(()=>S(()=>import("./CnXauPEG.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(c=>c.default||c)),ae=Q(()=>S(()=>import("./CH4oOQ9J.js"),__vite__mapDeps([7,8,1,2,5]),import.meta.url).then(c=>c.default||c)),re={class:"container mx-auto px-4 py-6"},ne={key:0,class:"text-center py-10"},le={key:1,class:"my-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded relative",role:"alert"},de={class:"block sm:inline"},ie={key:3,class:"overflow-x-auto bg-white dark:bg-gray-800 shadow rounded-lg"},ce={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ue={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},xe={class:"px-6 py-4 whitespace-nowrap"},pe={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ge={class:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-xs"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ve={key:0},_e={key:1},fe={key:2},he={key:3},ke={key:4},be={class:"px-6 py-4 whitespace-nowrap text-center"},we={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Ce={class:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium rtl:text-right space-x-2 rtl:space-x-reverse"},Ee=["onClick"],Me=["onClick"],Te={key:4,class:"text-center py-10 text-gray-500 dark:text-gray-400"},Ve=W({__name:"index",setup(c){const w=X(),{$toast:h}=H(),g=l(!0),m=l(null),d=l([]),x=l(!1),y=l(null),v=l(!1),u=l(null),C=l(null),p=l(null),E=l("success"),M=async()=>{g.value=!0,m.value=null,R();try{const{data:o,error:e}=await w.from("quizzes").select(`
        *,
        lessons ( title ),
        study_courses ( title )
      `).order("created_at",{ascending:!1});if(e)throw e;d.value=o||[]}catch(o){console.error("Error fetching quizzes:",o),m.value=o,d.value=[]}finally{g.value=!1}},T=()=>{y.value=null,x.value=!0},z=o=>{y.value={...o},x.value=!0},B=()=>{y.value=null},j=o=>{V("تم حفظ الاختبار بنجاح!","success"),x.value=!1,D()},F=o=>{u.value=o,C.value={title:"تأكيد الحذف",message:`هل أنت متأكد من رغبتك في حذف الاختبار "${o.title}"؟ سيتم حذف جميع أسئلته ومحاولات الطلاب المتعلقة به. لا يمكن التراجع عن هذا الإجراء.`,confirmText:"نعم، حذف الاختبار",confirmClass:"bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelText:"إلغاء"},v.value=!0},I=async()=>{if(!u.value)return;const o=u.value.id,e=u.value.title;try{const{error:i}=await w.from("quizzes").delete().eq("id",o);if(i)throw i;d.value=d.value.filter(k=>k.id!==o),V(`تم حذف الاختبار "${e}" بنجاح.`,"success")}catch(i){console.error("Error deleting quiz:",i),O(`فشل حذف الاختبار: ${i.message}`,"error")}finally{u.value=null,v.value=!1}},P=o=>{if(!o)return"--";try{return new Date(o).toLocaleString("ar-EG",{dateStyle:"medium",timeStyle:"short"})}catch{return"تاريخ غير صالح"}},U=o=>{switch(o){case"lesson":return"اختبار درس";case"module":return"اختبار وحدة";case"final":return"اختبار نهائي";case"practice":return"اختبار تدريبي";default:return"غير محدد"}},V=(o,e="info")=>{h&&typeof h[e]=="function"?h[e](o):console.log(`[${e.toUpperCase()}] ${o}`)},O=(o,e)=>{p.value=o,E.value=e,setTimeout(()=>{p.value=null},5e3)},R=()=>{p.value=null},D=()=>{M()};return J(()=>{M()}),(o,e)=>{const i=te,k=oe,Z=ae;return r(),a("div",re,[t("div",{class:"flex justify-between items-center mb-6"},[e[4]||(e[4]=t("h1",{class:"text-2xl font-semibold text-gray-700 dark:text-gray-200"},"إدارة الاختبارات",-1)),t("button",{onClick:T,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"},e[3]||(e[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-4 h-4 -ml-1 mr-2 rtl:ml-2 rtl:-mr-1"},[t("path",{"fill-rule":"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm.75-10.25v2.5h2.5a.75.75 0 0 1 0 1.5h-2.5v2.5a.75.75 0 0 1-1.5 0v-2.5h-2.5a.75.75 0 0 1 0-1.5h2.5v-2.5a.75.75 0 0 1 1.5 0Z","clip-rule":"evenodd"})],-1),b(" إنشاء اختبار جديد ")]))]),g.value?(r(),a("div",ne,[f(se),e[5]||(e[5]=t("p",{class:"mt-2 text-gray-500 dark:text-gray-400"},"جارٍ تحميل الاختبارات...",-1))])):_("",!0),m.value?(r(),a("div",le,[e[6]||(e[6]=t("strong",{class:"font-bold"},"خطأ!",-1)),t("span",de," حدث خطأ أثناء جلب الاختبارات. ("+n(m.value.message)+")",1),t("button",{onClick:D,class:"ml-4 text-red-800 underline"},"إعادة المحاولة")])):_("",!0),p.value?(r(),a("div",{key:2,class:N(["my-4 p-3 border rounded text-sm",E.value==="success"?"bg-green-100 border-green-300 text-green-700":"bg-red-100 border-red-300 text-red-700"])},n(p.value),3)):_("",!0),d.value&&d.value.length>0?(r(),a("div",ie,[t("table",ce,[e[8]||(e[8]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"العنوان"),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"النوع"),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"مرتبط بـ"),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"الحالة"),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"تاريخ الإنشاء"),t("th",{scope:"col",class:"relative px-6 py-3"},[t("span",{class:"sr-only"},"الإجراءات")])])],-1)),t("tbody",ue,[(r(!0),a(K,null,Y(d.value,s=>{var $,A,L;return r(),a("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",xe,[t("div",pe,n(s.title),1),t("div",ge,n(s.description),1)]),t("td",me,n(U(s.type)),1),t("td",ye,[s.type==="lesson"?(r(),a("span",ve,"درس: "+n((($=s.lessons)==null?void 0:$.title)||s.lesson_id),1)):s.type==="module"?(r(),a("span",_e,"وحدة "+n(s.module_number)+" في دورة: "+n(((A=s.study_courses)==null?void 0:A.title)||s.course_id),1)):s.type==="final"?(r(),a("span",fe,"دورة: "+n(((L=s.study_courses)==null?void 0:L.title)||s.course_id),1)):s.type==="practice"?(r(),a("span",he,"تدريبي")):(r(),a("span",ke,"--"))]),t("td",be,[t("span",{class:N(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.is_active?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/50 dark:text-gray-300"])},n(s.is_active?"نشط":"غير نشط"),3)]),t("td",we,n(P(s.created_at)),1),t("td",Ce,[f(i,{to:`/admin/quizzes/${s.id}/questions`,class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",title:"إدارة الأسئلة"},{default:q(()=>e[7]||(e[7]=[b("الأسئلة")])),_:2},1032,["to"]),t("button",{onClick:G=>z(s),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:"تعديل الاختبار"},"تعديل",8,Ee),t("button",{onClick:G=>F(s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"حذف الاختبار"},"حذف",8,Me)])])}),128))])])])):g.value?_("",!0):(r(),a("div",Te,[e[9]||(e[9]=b(" لا توجد اختبارات تم إنشاؤها بعد. ")),t("button",{onClick:T,class:"ml-2 text-indigo-600 hover:underline"},"إنشاء أول اختبار")])),f(k,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),"quiz-data":y.value,onSaved:j,onClosed:B},null,8,["modelValue","quiz-data"]),f(Z,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),config:C.value,onConfirm:I,onClose:e[2]||(e[2]=s=>u.value=null)},null,8,["modelValue","config"])])}}}),Le=ee(Ve,[["__scopeId","data-v-575d39c0"]]);export{Le as default};
