import{_ as h}from"./CEyFpblA.js";import{e as k,u as _,r as n,k as C,c as u,a as s,i,B as z,n as f,t as V,v as B,x as w,y as x,d as g,b as N,w as S,o as d,z as T,_ as M}from"./CaF1xe-H.js";const P={class:"flex items-center justify-center min-h-[calc(100vh-200px)] py-12 px-4 sm:px-6 lg:px-8"},E={class:"w-full max-w-md space-y-8 bg-white p-8 md:p-10 rounded-lg shadow border border-cream-gray"},U={key:0,class:"mt-2 text-center text-sm text-gray-600"},j={class:"rounded-md shadow-sm -space-y-px"},q=["disabled"],D={key:0,class:"absolute inset-y-0 left-0 flex items-center pl-3"},R={key:2,class:"text-sm text-center mt-4"},A=k({__name:"reset-password",setup(F){const p=_(),c=n(""),m=n(""),t=n(""),o=n(!1),a=n(!1),r=n(!1);C(()=>{setTimeout(async()=>{const{data:{session:l}}=await p.auth.getSession();l?r.value=!0:(t.value="الرابط المستخدم غير صالح أو انتهت صلاحيته. يرجى طلب رابط جديد.",o.value=!0,r.value=!1)},500)});const y=async()=>{if(c.value!==m.value){t.value="كلمتا المرور غير متطابقتين.",o.value=!0;return}a.value=!0,t.value="",o.value=!1;const{error:l}=await p.auth.updateUser({password:c.value});a.value=!1,l?(console.error("Reset Password Error:",l.message),t.value=l.message||"حدث خطأ أثناء تحديث كلمة المرور.",o.value=!0):(t.value="تم تحديث كلمة المرور بنجاح! سيتم تسجيل خروجك الآن. يمكنك تسجيل الدخول بكلمة المرور الجديدة.",o.value=!1,r.value=!1,await p.auth.signOut(),setTimeout(()=>T("/login"),3e3))};return(l,e)=>{const b=h;return d(),u("div",P,[s("div",E,[s("div",null,[e[2]||(e[2]=s("h2",{class:"mt-6 text-center text-3xl font-bold tracking-tight text-brown-dark"}," إعادة تعيين كلمة المرور ",-1)),!r.value&&!t.value?(d(),u("p",U," {/* تعديل شرط الرسالة */} جارٍ التحقق من الرابط... ")):i("",!0)]),t.value?(d(),u("div",{key:0,class:f([o.value?"text-red-600":"text-green-600","text-center text-sm mb-4 p-2 bg-opacity-10 rounded"]),style:z({backgroundColor:o.value?"rgba(239, 68, 68, 0.1)":"rgba(34, 197, 94, 0.1)"})},V(t.value),7)):i("",!0),r.value?(d(),u("form",{key:1,class:"mt-8 space-y-6",onSubmit:B(y,["prevent"])},[e[6]||(e[6]=s("input",{type:"hidden",name:"remember",value:"true"},null,-1)),s("div",j,[s("div",null,[e[3]||(e[3]=s("label",{for:"password",class:"sr-only"},"كلمة المرور الجديدة",-1)),w(s("input",{id:"password",name:"password",type:"password","onUpdate:modelValue":e[0]||(e[0]=v=>c.value=v),autocomplete:"new-password",required:"",class:"relative block w-full appearance-none rounded-none rounded-t-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm",placeholder:"كلمة المرور الجديدة (8+ حروف، رموز، إلخ)"},null,512),[[x,c.value]])]),s("div",null,[e[4]||(e[4]=s("label",{for:"confirm-password",class:"sr-only"},"تأكيد كلمة المرور الجديدة",-1)),w(s("input",{id:"confirm-password",name:"confirm-password",type:"password","onUpdate:modelValue":e[1]||(e[1]=v=>m.value=v),autocomplete:"new-password",required:"",class:"relative block w-full appearance-none rounded-none rounded-b-md border border-cream-gray px-3 py-2 text-brown-dark placeholder-gray-500 focus:z-10 focus:border-olive-green focus:outline-none focus:ring-olive-green sm:text-sm",placeholder:"تأكيد كلمة المرور الجديدة"},null,512),[[x,m.value]])])]),s("div",null,[s("button",{type:"submit",disabled:a.value,class:"group relative flex w-full justify-center rounded-md border border-transparent bg-olive-green py-2 px-4 text-sm font-medium text-white hover:bg-opacity-85 focus:outline-none focus:ring-2 focus:ring-olive-green focus:ring-offset-2 disabled:opacity-50"},[a.value?(d(),u("span",D,e[5]||(e[5]=[s("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):i("",!0),s("span",{class:f({"opacity-0":a.value})},"تحديث كلمة المرور",2)],8,q)])],32)):i("",!0),!r.value&&!a.value&&!o.value?(d(),u("div",R,[e[8]||(e[8]=g(" {/* تعديل الشرط */} ")),N(b,{to:"/login",class:"font-medium text-olive-green hover:underline"},{default:S(()=>e[7]||(e[7]=[g(" العودة لتسجيل الدخول ")])),_:1})])):i("",!0)])])}}}),L=M(A,[["__scopeId","data-v-4f8779b1"]]);export{L as default};
