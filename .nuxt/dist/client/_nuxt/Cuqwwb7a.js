import{_ as Ne}from"./CEyFpblA.js";import{_ as Ae}from"./C2nUyU-9.js";import{L as $e}from"./CpjGp_h0.js";import{e as Ie,u as Le,C as Ee,E as Me,a0 as qe,g as N,a2 as A,r as Qe,f as Te,l as _e,c as l,i as x,h as y,b as S,a as t,t as f,w as Z,d as k,F as j,j as R,V as oe,a3 as ye,o,p as Be,B as Ze,n as U,z as he,_ as je}from"./CaF1xe-H.js";import{u as Re}from"./CqvecxAQ.js";import{u as Ue}from"./C0vmt3Ib.js";const Fe={class:"container mx-auto px-4 py-8 md:py-12"},Pe={key:0,class:"text-center py-20"},Ve={key:1,class:"text-center py-10 px-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700/50 rounded-lg max-w-lg mx-auto shadow-md"},He={class:"flex justify-center items-center text-red-600 dark:text-red-400 mb-4"},Se={class:"text-xl font-semibold ms-2"},We={class:"text-sm text-red-700 dark:text-red-300 mb-5"},Oe={key:2,class:"course-details space-y-8 md:space-y-12"},Ke={class:"md:flex md:items-start md:gap-8 p-4 sm:p-6 md:p-8 bg-gradient-to-b from-gray-50 to-white dark:from-gray-800/50 dark:to-gray-900 rounded-lg shadow-sm border dark:border-gray-700/50"},Je={class:"w-full md:w-1/3 lg:w-1/4 flex-shrink-0 mb-4 md:mb-0"},Xe=["src","alt"],Ye={class:"flex-grow"},Ge={class:"text-3xl font-bold text-brown-dark dark:text-beige-light mb-3"},De={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mb-3"},es={class:"font-medium text-gray-700 dark:text-gray-300"},ss={key:1,class:"text-gray-700 dark:text-gray-300 mb-5 leading-relaxed"},ts={class:"space-y-4"},os={key:0},rs=["disabled"],ls={key:0},ns={key:1},as={key:1,class:"space-y-3 bg-green-50 dark:bg-green-900/20 p-4 rounded-md border border-green-200 dark:border-green-700/50"},ds={key:0,class:"progress-section pt-2"},is={class:"flex justify-between mb-1 text-xs font-medium text-gray-600 dark:text-gray-400"},us={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 overflow-hidden"},cs={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ms={key:1,class:"text-xs text-gray-500 dark:text-gray-400 italic pt-2"},gs={class:"flex items-center gap-4 pt-3 mt-2 border-t border-green-200 dark:border-green-700/50"},ps=["disabled"],fs={key:2,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},vs={class:"flex flex-wrap gap-2"},_s=["onClick","title","disabled"],ys={key:0,class:"ms-1.5 text-xxs opacity-80 text-green-100"},hs={class:"course-content"},bs={key:0,class:"text-center py-10 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800/30 rounded-lg border border-dashed dark:border-gray-700"},xs={key:1,class:"space-y-6"},ks={class:"module-header flex flex-wrap items-center justify-between gap-3 mb-4 pb-3 border-b border-gray-200 dark:border-gray-700"},ws={class:"text-lg font-semibold text-primary dark:text-primary-400"},Cs={key:0,class:"font-mono me-1.5 text-sm opacity-80"},zs={key:0,class:"flex flex-wrap gap-2"},Ns=["onClick","title","disabled"],As={key:0,class:"ms-1.5 text-xxs opacity-80 text-green-100"},$s={key:0,class:"space-y-2"},Is={class:"flex items-center space-x-3 rtl:space-x-reverse flex-grow min-w-0"},Ls={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-4 h-4"},Es={key:1,class:"font-mono"},Ms={class:"truncate"},qs={key:0,class:"flex flex-wrap gap-1.5 mt-1 sm:mt-0 flex-shrink-0 w-full sm:w-auto justify-start sm:justify-end"},Qs=["onClick","title","disabled"],Ts={key:0,class:"ms-1 text-xxs opacity-80 text-indigo-800 dark:text-indigo-300"},Bs={key:1,class:"h-[30px] flex-shrink-0 w-full sm:w-auto sm:min-w-[100px]"},Zs={key:1,class:"text-sm text-gray-500 dark:text-gray-400 italic px-3 py-4 text-center"},js=Ie({__name:"index",async setup(Rs){let F,re;const w=Le(),W=Ee(),be=Me(),{profile:$,isLoggedIn:M}=qe(be),q=N(()=>{const e=parseInt(W.params.courseId,10);return isNaN(e)||e<=0?(ye({statusCode:400,statusMessage:`معرف الدورة غير صالح: "${W.params.courseId}"`,fatal:!0}),NaN):e}),v=A(null),le=A([]),Q=A([]),T=A([]),ne=A([]),O=A(null),K=A(null),J=A([]),h=Qe(!1);isNaN(q.value)&&console.error("Course ID is invalid, stopping component setup.");const{data:xe,pending:P,error:C,refresh:ae}=([F,re]=Te(async()=>{var e;return Re(`course-page-data-${q.value}-${((e=$.value)==null?void 0:e.id)??"guest"}`,async()=>{var a,u,n,g;const s=q.value;if(isNaN(s))throw oe({statusCode:400,message:"معرف الدورة غير صالح عند بدء الجلب.",fatal:!0});const r=(a=$.value)==null?void 0:a.id;console.log(`[useAsyncData] Fetching data for course ${s}, User ${r??"Guest"}`);try{console.log("[useAsyncData] Fetching main course data, category, modules, lessons...");const{data:c,error:L}=await w.from("study_courses").select(`
                    *,
                    category:categories ( name ),
                    modules:course_modules!course_id ( id, title, module_number ),
                    lessons:lessons!course_id ( id, title, lesson_order, module_number, created_at )
                `).eq("id",s).eq("is_active",!0).single();if(L)throw console.error("[useAsyncData] Error fetching base course data:",L),oe({statusCode:500,statusMessage:`فشل جلب بيانات الدورة الرئيسية: ${L.message}`,fatal:!0});if(!c)throw console.warn(`[useAsyncData] Course ${s} not found or inactive.`),oe({statusCode:404,message:"الدورة المطلوبة غير موجودة أو غير نشطة.",fatal:!0});const V={...c,category:void 0,modules:void 0,lessons:void 0},H=((u=c.modules)==null?void 0:u.sort((p,_)=>(p.module_number??1/0)-(_.module_number??1/0)))??[],i=((n=c.lessons)==null?void 0:n.sort((p,_)=>{const E=(p.module_number??1/0)-(_.module_number??1/0);if(E!==0)return E;const ve=(p.lesson_order??1/0)-(_.lesson_order??1/0);return ve!==0?ve:new Date(p.created_at??0).getTime()-new Date(_.created_at??0).getTime()}))??[],d=((g=c.category)==null?void 0:g.name)??null,I=i.map(p=>p.id);console.log("[useAsyncData] Fetching course-level and lesson-level quizzes...");let m=[];const{data:ge,error:pe}=await w.from("quizzes").select("id, title, lesson_id, module_number, course_id, is_active").eq("course_id",s).eq("is_active",!0);if(pe?console.error("Error fetching course-linked quizzes:",pe.message):m=m.concat(ge??[]),I.length>0){const{data:p,error:_}=await w.from("quizzes").select("id, title, lesson_id, module_number, course_id, is_active").in("lesson_id",I).eq("is_active",!0);_?console.error("Error fetching lesson-linked quizzes:",_.message):m=m.concat(p??[])}m=Array.from(new Map(m.map(p=>[p.id,p])).values()),console.log(`[useAsyncData] Total active quizzes fetched: ${m.length}`),console.log("[useAsyncData] Fetching user-specific data...");let ee=null,se=[],te=[];const fe=m.map(p=>p.id);if(M.value&&r){const[p,_,E]=await Promise.all([w.from("course_enrollments").select("*").eq("user_id",r).eq("course_id",s).maybeSingle(),I.length>0?w.from("lesson_completions").select("lesson_id").eq("user_id",r).in("lesson_id",I):Promise.resolve({data:[],error:null}),fe.length>0?w.from("quiz_attempts").select("id, quiz_id, passed, submitted_at").eq("user_id",r).in("quiz_id",fe):Promise.resolve({data:[],error:null})]);p.error?console.error("Enrollment fetch error:",p.error.message):ee=p.data,_.error?console.error("Completions fetch error:",_.error.message):se=_.data??[],E.error?console.error("Attempts fetch error:",E.error.message):te=E.data??[],console.log(`[useAsyncData] User data fetched. Enrolled: ${!!ee}, Completions: ${se.length}, Attempts: ${te.length}`)}else console.log("[useAsyncData] User not logged in, skipping user-specific data fetch.");return console.log("[useAsyncData] Fetch process complete."),{course:V,modules:H,lessons:i,quizzes:m,categoryName:d,enrollment:ee,completions:se,attempts:te}}catch(c){if(console.error("[useAsyncData] CRITICAL ERROR during data fetching:",c),c.statusCode&&c.fatal)throw c;return ye({statusCode:c.statusCode||500,message:`حدث خطأ غير متوقع أثناء تحميل بيانات الدورة: ${c.message||"خطأ غير معروف"}`,fatal:!0}),{course:null,modules:[],lessons:[],quizzes:[],attempts:[],categoryName:null,enrollment:null,completions:[]}}},{default:()=>({course:null,modules:[],lessons:[],quizzes:[],attempts:[],categoryName:null,enrollment:null,completions:[]}),watch:[()=>{var s;return(s=$.value)==null?void 0:s.id}]})}),F=await F,re(),F);_e(xe,e=>{console.log("[Watcher] Updating local state from fetched data."),v.value=(e==null?void 0:e.course)??null,le.value=Array.isArray(e==null?void 0:e.modules)?e.modules:[],Q.value=Array.isArray(e==null?void 0:e.lessons)?e.lessons:[],T.value=Array.isArray(e==null?void 0:e.quizzes)?e.quizzes:[],ne.value=Array.isArray(e==null?void 0:e.attempts)?e.attempts:[],O.value=(e==null?void 0:e.categoryName)??null,K.value=(e==null?void 0:e.enrollment)??null,J.value=Array.isArray(e==null?void 0:e.completions)?e.completions.map(s=>s.lesson_id):[],console.log("[Watcher] Local state updated. Course:",!!v.value,"Lessons:",Q.value.length,"Quizzes:",T.value.length),!P.value&&!C.value&&!(e!=null&&e.course)&&console.warn("[Watcher] No course data found after loading.")},{immediate:!0});const z=N(()=>!!K.value),B=N(()=>Q.value.length),de=N(()=>J.value.length),ie=N(()=>{if(B.value===0)return 0;const e=Math.min(de.value,B.value);return Math.round(e/B.value*100)}),X=N(()=>{const e=new Map;for(const s of T.value)if(s.lesson_id!==null&&!isNaN(Number(s.lesson_id))){const r=Number(s.lesson_id);e.has(r)||e.set(r,[]),e.get(r).push(s)}return e.forEach(s=>s.sort((r,a)=>(r.title||"").localeCompare(a.title||""))),e}),ue=N(()=>T.value.filter(e=>e.lesson_id===null&&e.module_number===null).sort((e,s)=>(e.title||"").localeCompare(s.title||""))),ce=N(()=>{var u;const e=new Map;for(const n of le.value)n.module_number!==null?e.set(n.module_number,{moduleNumber:n.module_number,moduleTitle:n.title||`الوحدة ${n.module_number}`,lessons:[],quizzes:[]}):console.warn(`Module ID ${n.id} has null module_number.`);const s="general";e.set(s,{moduleNumber:null,moduleTitle:"دروس أو اختبارات عامة",lessons:[],quizzes:[]});for(const n of Q.value){const g=n.module_number!==null?n.module_number:s,c=e.get(g);c?c.lessons.push(n):(u=e.get(s))==null||u.lessons.push(n)}for(const n of T.value)if(n.module_number!==null&&n.lesson_id===null){const g=e.get(n.module_number);g?g.quizzes.push(n):console.warn(`Module quiz ${n.id} (module ${n.module_number}) has no matching group.`)}e.forEach(n=>n.quizzes.sort((g,c)=>(g.title||"").localeCompare(c.title||"")));const r=e.get(s);return r&&r.lessons.length===0&&r.quizzes.length===0&&e.delete(s),Array.from(e.values()).sort((n,g)=>n.moduleNumber===null?-1:g.moduleNumber===null?1:n.moduleNumber-g.moduleNumber)}),Y=e=>J.value.includes(e),ke=e=>e||"/images/placeholder-course.jpg",me=e=>e?`/study/courses/${q.value}/lessons/${e}`:"#",b=e=>{if(!e||!M.value)return!1;const s=Number(e),r=ne.value.filter(a=>a.quiz_id===s&&a.submitted_at!==null).sort((a,u)=>new Date(u.submitted_at).getTime()-new Date(a.submitted_at).getTime());return r.length>0&&r[0].passed===!0},G=e=>M.value&&z.value,we=async e=>{var r;const s=Number(e);if(!(!s||!M.value||!((r=$.value)!=null&&r.id)||z.value||h.value)){h.value=!0;try{const{data:a,error:u}=await w.from("course_enrollments").insert({user_id:$.value.id,course_id:s}).select("*").single();if(u)throw u;await ae(),console.log("Enrollment successful!")}catch(a){console.error("Enrollment error:",a)}finally{h.value=!1}}},Ce=async e=>{var r;const s=Number(e);if(!(!s||!z.value||!((r=$.value)!=null&&r.id)||h.value)&&confirm("هل أنت متأكد من إلغاء الانتساب لهذه الدورة؟ سيتم حذف تقدمك المحفوظ المتعلق بهذه الدورة.")){h.value=!0;try{const{error:a}=await w.from("course_enrollments").delete().match({user_id:$.value.id,course_id:s});if(a)throw a;await ae(),console.log("Unenrollment successful!")}catch(a){console.error("Unenrollment error:",a)}finally{h.value=!1}}},ze=()=>{var n,g;const e=q.value;if(isNaN(e)||!z.value)return;const s=(n=K.value)==null?void 0:n.last_accessed_lesson_id,r=Q.value,a=r.length>0?(g=r[0])==null?void 0:g.id:void 0,u=s&&r.some(c=>c.id===s)?s:a;u?he(me(u)):console.warn("No lessons found to navigate to for last accessed/first lesson.")},D=e=>{e&&he(`/quizzes/${String(e)}`)};return _e([v,P,C],([e,s,r])=>{var n;let a="تفاصيل الدورة",u="تصفح محتوى الدورة والدروس المتاحة.";s?(a="جارٍ تحميل الدورة...",u="يتم الآن تحميل تفاصيل الدورة المطلوبة."):r&&r.statusCode===404?(a="الدورة غير متاحة",u="لم نتمكن من العثور على الدورة المطلوبة أو أنها غير نشطة حالياً."):r?(a="خطأ في تحميل الدورة",u=`حدث خطأ أثناء تحميل بيانات الدورة: ${r.message}`):e&&(a=`دورة: ${e.title}`,u=((n=e.description)==null?void 0:n.substring(0,160))||`تفاصيل ومحتوى دورة "${e.title}".`),Ue({title:a,meta:[{name:"description",content:u},{property:"og:title",content:a},{property:"og:description",content:u},{property:"og:type",content:"website"}]})},{immediate:!0}),(e,s)=>{var u,n,g,c,L,V,H;const r=Ne,a=Ae;return o(),l("div",Fe,[y(P)?(o(),l("div",Pe,[S($e,{class:"w-12 h-12 mx-auto text-primary"}),s[2]||(s[2]=t("p",{class:"mt-4 text-base text-gray-600 dark:text-gray-400"},"جارٍ تحميل تفاصيل الدورة...",-1))])):y(C)||!v.value?(o(),l("div",Ve,[t("div",He,[s[3]||(s[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-7 h-7","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-8-5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-1.5 0v-4.5A.75.75 0 0 1 10 5Zm0 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z","clip-rule":"evenodd"})],-1)),t("h2",Se,f(((u=y(C))==null?void 0:u.statusCode)===404||!v.value?"الدورة غير متاحة":((g=(n=y(C))==null?void 0:n.data)==null?void 0:g.statusMessage)||((c=y(C))==null?void 0:c.message)||"حدث خطأ"),1)]),t("p",We,f(((V=(L=y(C))==null?void 0:L.data)==null?void 0:V.message)||((H=y(C))==null?void 0:H.message)||"لم نتمكن من العثور على الدورة المطلوبة أو حدث خطأ غير متوقع أثناء تحميلها."),1),S(r,{to:"/study",class:"button-secondary border-red-300 dark:border-red-600 text-red-700 dark:text-red-200 bg-red-100 dark:bg-red-800/60 hover:bg-red-200 dark:hover:bg-red-700/70 focus:ring-red-500 inline-flex items-center gap-1.5"},{default:Z(()=>s[4]||(s[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 ms-1","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.25-7.25a.75.75 0 0 0 0-1.5H8.66l2.1-1.95a.75.75 0 1 0-1.02-1.1l-3.5 3.25a.75.75 0 0 0 0 1.1l3.5 3.25a.75.75 0 0 0 1.02-1.1l-2.1-1.95h4.59Z","clip-rule":"evenodd"})],-1),t("span",null,"العودة لقائمة الدورات",-1)])),_:1})])):!y(P)&&v.value?(o(),l("div",Oe,[t("header",Ke,[t("div",Je,[t("img",{src:ke(v.value.image_url),alt:`غلاف دورة: ${v.value.title}`,class:"w-full aspect-video object-cover rounded-lg shadow-md"},null,8,Xe)]),t("div",Ye,[t("h1",Ge,f(v.value.title),1),O.value?(o(),l("p",De,[s[5]||(s[5]=k(" الفئة: ")),t("span",es,f(O.value),1)])):x("",!0),v.value.description?(o(),l("p",ss,f(v.value.description),1)):x("",!0),S(a,null,{fallback:Z(()=>s[11]||(s[11]=[t("div",{class:"h-10 bg-gray-200 dark:bg-gray-700 rounded-md animate-pulse w-full sm:w-40"},null,-1)])),default:Z(()=>[t("div",ts,[y(M)?(o(),l("div",os,[z.value?(o(),l("div",as,[s[8]||(s[8]=t("p",{class:"text-green-700 dark:text-green-300 font-semibold text-base flex items-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 me-1.5 flex-shrink-0","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M16.403 12.652a3 3 0 0 0 0-5.304 3 3 0 0 0-3.75-3.751 3 3 0 0 0-5.305 0 3 3 0 0 0-3.751 3.75 3 3 0 0 0 0 5.305 3 3 0 0 0 3.75 3.751 3 3 0 0 0 5.305 0 3 3 0 0 0 3.751-3.75Zm-2.546-4.46a.75.75 0 0 0-1.214-.883l-3.48 4.774L6.52 10.91a.75.75 0 1 0-1.04 1.08l2.18 2.108a.75.75 0 0 0 1.076-.015l4.145-5.682Z","clip-rule":"evenodd"})]),k(" أنت منتسب لهذه الدورة ")],-1)),B.value>0?(o(),l("div",ds,[t("div",is,[s[6]||(s[6]=t("span",null,"التقدم",-1)),t("span",null,f(ie.value)+"%",1)]),t("div",us,[t("div",{class:"bg-primary h-2.5 rounded-full transition-all duration-500 ease-out",style:Ze({width:ie.value+"%"})},null,4)]),t("p",cs,f(de.value)+" / "+f(B.value)+" درس مكتمل",1)])):(o(),l("div",ms," (لم تتم إضافة دروس لهذه الدورة بعد)")),t("div",gs,[t("button",{onClick:ze,class:"button-secondary flex-grow sm:flex-grow-0 text-sm"},s[7]||(s[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4 me-1.5","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z","clip-rule":"evenodd"})],-1),k(" استئناف التعلم ")])),t("button",{onClick:s[1]||(s[1]=i=>{var d;return Ce((d=v.value)==null?void 0:d.id)}),disabled:h.value,class:"text-xs text-red-500 hover:text-red-700 dark:hover:text-red-300 underline disabled:opacity-50 disabled:cursor-not-allowed"},"إلغاء الانتساب",8,ps)])])):(o(),l("button",{key:0,onClick:s[0]||(s[0]=i=>{var d;return we((d=v.value)==null?void 0:d.id)}),disabled:h.value,class:"button-enroll w-full sm:w-auto"},[h.value?(o(),l("span",ls,"جاري الانتساب...")):(o(),l("span",ns,"انتسب الآن"))],8,rs))])):(o(),Be(r,{key:1,to:`/login?redirect=${y(W).fullPath}`,class:"button-enroll w-full sm:w-auto"},{default:Z(()=>s[9]||(s[9]=[k("سجل الدخول للانتساب")])),_:1},8,["to"])),z.value&&ue.value.length>0?(o(),l("div",fs,[s[10]||(s[10]=t("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-3"},"الاختبارات النهائية للدورة:",-1)),t("div",vs,[(o(!0),l(j,null,R(ue.value,i=>(o(),l("button",{key:i.id,onClick:d=>D(i.id),class:U(["button-quiz-base button-quiz-course",{passed:b(i.id)}]),title:b(i.id)?`تم اجتياز الاختبار: ${i.title}`:i.title,disabled:!G(i.id)},[k(f(i.title||"الاختبار النهائي")+" ",1),b(i.id)?(o(),l("span",ys,"(تم الاجتياز - عرض النتيجة)")):x("",!0)],10,_s))),128))])])):x("",!0)])]),_:1})])]),t("section",hs,[s[14]||(s[14]=t("h2",{class:"text-2xl font-semibold text-brown-dark dark:text-beige-light mb-6"},"محتوى الدورة",-1)),ce.value.length===0?(o(),l("div",bs,s[12]||(s[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-10 h-10 mx-auto mb-3 text-gray-400 dark:text-gray-500"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})],-1),k(" سيتم إضافة محتوى لهذه الدورة قريبًا إن شاء الله. ")]))):(o(),l("div",xs,[(o(!0),l(j,null,R(ce.value,i=>(o(),l("div",{key:i.moduleNumber??"general",class:"module-section bg-white dark:bg-gray-800/40 p-4 sm:p-5 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"},[t("div",ks,[t("h3",ws,[i.moduleNumber!==null?(o(),l("span",Cs,"#"+f(i.moduleNumber),1)):x("",!0),k(" "+f(i.moduleTitle),1)]),z.value&&i.quizzes.length>0?(o(),l("div",zs,[(o(!0),l(j,null,R(i.quizzes,d=>(o(),l("button",{key:d.id,onClick:I=>D(d.id),class:U(["button-quiz-base button-quiz-module",{passed:b(d.id)}]),title:b(d.id)?`تم اجتياز الاختبار: ${d.title}`:d.title,disabled:!G(d.id)},[k(f(d.title||`اختبار الوحدة ${i.moduleNumber}`)+" ",1),b(d.id)?(o(),l("span",As,"(تم الاجتياز - عرض النتيجة)")):x("",!0)],10,Ns))),128))])):x("",!0)]),i.lessons.length>0?(o(),l("ul",$s,[(o(!0),l(j,null,R(i.lessons,(d,I)=>(o(),l("li",{key:d.id,class:U(["flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 rounded-md transition-colors duration-150 gap-2 sm:gap-4",Y(d.id)?"lesson-completed":"lesson-incomplete"])},[t("div",Is,[t("span",{class:U(["lesson-status-icon",Y(d.id)?"completed":"incomplete"]),"aria-hidden":"true"},[Y(d.id)?(o(),l("svg",Ls,s[13]||(s[13]=[t("path",{"fill-rule":"evenodd",d:"M12.416 3.376a.75.75 0 0 1 .208 1.04l-5 7.5a.75.75 0 0 1-1.154.114l-3-3a.75.75 0 0 1 1.06-1.06l2.353 2.353 4.493-6.74a.75.75 0 0 1 1.04-.208Z","clip-rule":"evenodd"},null,-1)]))):(o(),l("span",Es,f(d.lesson_order??I+1),1))],2),S(r,{to:me(d.id),class:"lesson-title-link flex-1 min-w-0"},{default:Z(()=>[t("span",Ms,f(d.title),1)]),_:2},1032,["to"])]),z.value&&X.value.get(d.id)&&X.value.get(d.id).length>0?(o(),l("div",qs,[(o(!0),l(j,null,R(X.value.get(d.id),m=>(o(),l("button",{key:m.id,onClick:ge=>D(m.id),class:U(["button-quiz-base button-quiz-lesson",{passed:b(m.id)}]),title:b(m.id)?`تم اجتياز الاختبار: ${m.title}`:m.title,disabled:!G(m.id)},[k(f(m.title||"اختبار الدرس")+" ",1),b(m.id)?(o(),l("span",Ts,"(تم الاجتياز - عرض النتيجة)")):x("",!0)],10,Qs))),128))])):(o(),l("div",Bs))],2))),128))])):(o(),l("p",Zs,"لا توجد دروس في هذه الوحدة بعد."))]))),128))]))])])):x("",!0)])}}}),Ws=je(js,[["__scopeId","data-v-6e3553fa"]]);export{Ws as default};
