import{_ as $e}from"./CEyFpblA.js";import{e as ne,q as oe,r as v,g as L,l as ce,m as Ie,c as l,i as k,o,a as r,b as H,v as ee,T as be,w as te,h as B,F as me,u as ve,t as T,x as G,$ as F,y as ae,a5 as ue,a0 as _e,E as ke,a8 as Pe,j as Ce,p as Se,_ as ze,k as Le,d as X}from"./CaF1xe-H.js";import{_ as re}from"./Cjm1-dYk.js";import{a as Re,e as We,c as He,n as Ne,g as Be,b as ye,d as qe,f as de,h as V,i as Y,j as Oe}from"./Bqepao4b.js";import{m as he,a as ge,b as xe,d as we}from"./DhpZqJBn.js";import{L as je}from"./CpjGp_h0.js";function Ue(s,D,t){const C=Re(),m=(t==null?void 0:t.locale)??C.locale??We,x=He(s,D);if(isNaN(x))throw new RangeError("Invalid time value");const h=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:x}),[n,u]=Ne(t==null?void 0:t.in,...x>0?[D,s]:[s,D]),b=Be((t==null?void 0:t.roundingMethod)??"round"),g=u.getTime()-n.getTime(),y=g/we,S=ye(u)-ye(n),_=(g-S)/we,d=t==null?void 0:t.unit;let i;if(d?i=d:y<1?i="second":y<60?i="minute":y<he?i="hour":_<ge?i="day":_<xe?i="month":i="year",i==="second"){const f=b(g/1e3);return m.formatDistance("xSeconds",f,h)}else if(i==="minute"){const f=b(y);return m.formatDistance("xMinutes",f,h)}else if(i==="hour"){const f=b(y/60);return m.formatDistance("xHours",f,h)}else if(i==="day"){const f=b(_/he);return m.formatDistance("xDays",f,h)}else if(i==="month"){const f=b(_/ge);return f===12&&d!=="month"?m.formatDistance("xYears",1,h):m.formatDistance("xMonths",f,h)}else{const f=b(_/xe);return m.formatDistance("xYears",f,h)}}function Me(s,D){return Ue(s,qe(s),D)}const Ae={lessThanXSeconds:{one:"أقل من ثانية",two:"أقل من ثانيتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية واحدة",two:"ثانيتان",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نصف دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقائق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة واحدة",two:"دقيقتان",threeToTen:"{{count}} دقائق",other:"{{count}} دقيقة"},aboutXHours:{one:"ساعة واحدة تقريباً",two:"ساعتين تقريبا",threeToTen:"{{count}} ساعات تقريباً",other:"{{count}} ساعة تقريباً"},xHours:{one:"ساعة واحدة",two:"ساعتان",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم واحد",two:"يومان",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"أسبوع واحد تقريبا",two:"أسبوعين تقريبا",threeToTen:"{{count}} أسابيع تقريبا",other:"{{count}} أسبوعا تقريبا"},xWeeks:{one:"أسبوع واحد",two:"أسبوعان",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوعا"},aboutXMonths:{one:"شهر واحد تقريباً",two:"شهرين تقريبا",threeToTen:"{{count}} أشهر تقريبا",other:"{{count}} شهرا تقريباً"},xMonths:{one:"شهر واحد",two:"شهران",threeToTen:"{{count}} أشهر",other:"{{count}} شهرا"},aboutXYears:{one:"سنة واحدة تقريباً",two:"سنتين تقريبا",threeToTen:"{{count}} سنوات تقريباً",other:"{{count}} سنة تقريباً"},xYears:{one:"سنة واحد",two:"سنتان",threeToTen:"{{count}} سنوات",other:"{{count}} سنة"},overXYears:{one:"أكثر من سنة",two:"أكثر من سنتين",threeToTen:"أكثر من {{count}} سنوات",other:"أكثر من {{count}} سنة"},almostXYears:{one:"ما يقارب سنة واحدة",two:"ما يقارب سنتين",threeToTen:"ما يقارب {{count}} سنوات",other:"ما يقارب {{count}} سنة"}},Fe=(s,D,t)=>{const C=Ae[s];let m;return typeof C=="string"?m=C:D===1?m=C.one:D===2?m=C.two:D<=10?m=C.threeToTen.replace("{{count}}",String(D)):m=C.other.replace("{{count}}",String(D)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"خلال "+m:"منذ "+m:m},Ke={full:"EEEE، do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},Xe={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},Ve={full:"{{date}} 'عند الساعة' {{time}}",long:"{{date}} 'عند الساعة' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ye={date:de({formats:Ke,defaultWidth:"full"}),time:de({formats:Xe,defaultWidth:"full"}),dateTime:de({formats:Ve,defaultWidth:"full"})},Ge={lastWeek:"eeee 'الماضي عند الساعة' p",yesterday:"'الأمس عند الساعة' p",today:"'اليوم عند الساعة' p",tomorrow:"'غدا عند الساعة' p",nextWeek:"eeee 'القادم عند الساعة' p",other:"P"},Qe=s=>Ge[s],Je={narrow:["ق","ب"],abbreviated:["ق.م.","ب.م."],wide:["قبل الميلاد","بعد الميلاد"]},Ze={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},et={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},tt={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},at={narrow:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"},abbreviated:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"},wide:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"}},rt={narrow:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"},abbreviated:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"},wide:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"}},nt=s=>String(s),ot={ordinalNumber:nt,era:V({values:Je,defaultWidth:"wide"}),quarter:V({values:Ze,defaultWidth:"wide",argumentCallback:s=>s-1}),month:V({values:et,defaultWidth:"wide"}),day:V({values:tt,defaultWidth:"wide"}),dayPeriod:V({values:at,defaultWidth:"wide",formattingValues:rt,defaultFormattingWidth:"wide"})},st=/^(\d+)(th|st|nd|rd)?/i,lt=/\d+/i,it={narrow:/[قب]/,abbreviated:/[قب]\.م\./,wide:/(قبل|بعد) الميلاد/},dt={any:[/قبل/,/بعد/]},ut={narrow:/^[1234]/i,abbreviated:/ر[1234]/,wide:/الربع (الأول|الثاني|الثالث|الرابع)/},ct={any:[/1/i,/2/i,/3/i,/4/i]},mt={narrow:/^[أيفمسند]/,abbreviated:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/,wide:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/},vt={narrow:[/^ي/i,/^ف/i,/^م/i,/^أ/i,/^م/i,/^ي/i,/^ي/i,/^أ/i,/^س/i,/^أ/i,/^ن/i,/^د/i],any:[/^يناير/i,/^فبراير/i,/^مارس/i,/^أبريل/i,/^مايو/i,/^يونيو/i,/^يوليو/i,/^أغسطس/i,/^سبتمبر/i,/^أكتوبر/i,/^نوفمبر/i,/^ديسمبر/i]},ft={narrow:/^[حنثرخجس]/i,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,abbreviated:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/i},pt={narrow:[/^ح/i,/^ن/i,/^ث/i,/^ر/i,/^خ/i,/^ج/i,/^س/i],wide:[/^الأحد/i,/^الاثنين/i,/^الثلاثاء/i,/^الأربعاء/i,/^الخميس/i,/^الجمعة/i,/^السبت/i],any:[/^أح/i,/^اث/i,/^ث/i,/^أر/i,/^خ/i,/^ج/i,/^س/i]},yt={narrow:/^(ص|م|منتصف الليل|الظهر|بعد الظهر|في الصباح|في المساء|في الليل)/,any:/^(ص|م|منتصف الليل|الظهر|بعد الظهر|في الصباح|في المساء|في الليل)/},ht={any:{am:/^ص/,pm:/^م/,midnight:/منتصف الليل/,noon:/الظهر/,afternoon:/بعد الظهر/,morning:/في الصباح/,evening:/في المساء/,night:/في الليل/}},gt={ordinalNumber:Oe({matchPattern:st,parsePattern:lt,valueCallback:s=>parseInt(s,10)}),era:Y({matchPatterns:it,defaultMatchWidth:"wide",parsePatterns:dt,defaultParseWidth:"any"}),quarter:Y({matchPatterns:ut,defaultMatchWidth:"wide",parsePatterns:ct,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Y({matchPatterns:mt,defaultMatchWidth:"wide",parsePatterns:vt,defaultParseWidth:"any"}),day:Y({matchPatterns:ft,defaultMatchWidth:"wide",parsePatterns:pt,defaultParseWidth:"any"}),dayPeriod:Y({matchPatterns:yt,defaultMatchWidth:"any",parsePatterns:ht,defaultParseWidth:"any"})},Te={code:"ar",formatDistance:Fe,formatLong:Ye,formatRelative:Qe,localize:ot,match:gt,options:{weekStartsOn:6,firstWeekContainsDate:1}},xt={key:0,class:"relative"},wt=["aria-label","aria-expanded"],bt={class:"py-1",role:"menu","aria-orientation":"vertical"},_t=["disabled","title"],Ee=ne({__name:"CommentActions",props:{item:{type:Object,required:!0},itemType:{type:String,required:!0},isCommentingSuspended:{type:Boolean,default:!1}},emits:["edit","delete","reply"],setup(s,{emit:D}){const t=s,C=D,m=oe(),x=v(!1),h=v(null),n=L(()=>m.value&&m.value.id===t.item.user_id),u=L(()=>!m.value&&!n.value?!1:!!(n.value||m.value&&t.itemType==="comment"&&!t.isCommentingSuspended)),b=()=>{x.value=!x.value},g=_=>{var d;if(h.value&&!h.value.contains(_.target)){const i=(d=h.value.parentElement)==null?void 0:d.querySelector("button");(!i||!i.contains(_.target))&&(x.value=!1)}},y=_=>{_.key==="Escape"&&(x.value=!1)};ce(x,_=>{_?(document.addEventListener("click",g,!0),document.addEventListener("keydown",y)):(document.removeEventListener("click",g,!0),document.removeEventListener("keydown",y))}),Ie(()=>{document.removeEventListener("click",g,!0),document.removeEventListener("keydown",y)});const S=_=>{if(_==="reply"&&t.isCommentingSuspended){x.value=!1;return}C(_),x.value=!1};return(_,d)=>u.value?(o(),l("div",xt,[r("button",{onClick:ee(b,["stop"]),"aria-label":`إجراءات ${s.itemType==="comment"?"التعليق":"الرد"}`,"aria-haspopup":"true","aria-expanded":x.value.toString(),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-white focus:outline-none p-1 -m-1 rounded-full"},d[3]||(d[3]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{d:"M10 6a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM10 11.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM10 17a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})],-1)]),8,wt),H(be,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:te(()=>[x.value?(o(),l("div",{key:0,ref_key:"dropdownMenuRef",ref:h,class:"origin-top-right rtl:origin-top-left absolute right-0 rtl:right-auto rtl:left-0 mt-2 w-32 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none dark:bg-gray-800 dark:ring-gray-700 z-20"},[r("div",bt,[s.itemType==="comment"&&B(m)?(o(),l("button",{key:0,onClick:d[0]||(d[0]=i=>S("reply")),disabled:s.isCommentingSuspended,class:"flex items-center gap-2 w-full text-right rtl:text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-200 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",role:"menuitem",title:s.isCommentingSuspended?"التعليق موقوف حاليًا":"الرد على هذا التعليق"},d[4]||(d[4]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M7.707 3.293a1 1 0 010 1.414L5.414 7H11a7 7 0 017 7v2a1 1 0 11-2 0v-2a5 5 0 00-5-5H5.414l2.293 2.293a1 1 0 11-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),r("span",null,"رد",-1)]),8,_t)):k("",!0),n.value?(o(),l(me,{key:1},[r("button",{onClick:d[1]||(d[1]=i=>S("edit")),class:"flex items-center gap-2 w-full text-right rtl:text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-200 dark:hover:bg-gray-700",role:"menuitem"},d[5]||(d[5]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),r("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"})],-1),r("span",null,"تعديل",-1)])),r("button",{onClick:d[2]||(d[2]=i=>S("delete")),class:"flex items-center gap-2 w-full text-right rtl:text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 dark:text-red-400 dark:hover:bg-red-900/50 dark:hover:text-red-300",role:"menuitem"},d[6]||(d[6]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),r("span",null,"حذف",-1)]))],64)):k("",!0)])],512)):k("",!0)]),_:1})])):k("",!0)}}),kt={class:"flex space-x-3 rtl:space-x-reverse py-3 border-t border-gray-200 dark:border-gray-700 first:border-t-0 first:pt-0 last:pb-0"},Ct={class:"flex-1 min-w-0"},St={class:"flex items-center justify-between gap-2"},Mt={class:"text-sm font-semibold text-gray-900 dark:text-white truncate"},Tt={class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},Et=["datetime","title"],Dt={key:0,class:"mx-1",title:"تم تعديل هذا الرد"},$t={key:0,class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words"},It={key:1},Pt=["disabled","onKeydown"],zt={class:"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse"},Lt={key:0,class:"text-xs text-red-500 flex-1 text-right"},Rt=["disabled"],Wt=["disabled"],Ht={key:0,class:"animate-spin -ml-0.5 mr-1.5 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Nt=ne({__name:"ReplyItem",props:{reply:{}},emits:["replyUpdated","replyDeleted"],setup(s,{emit:D}){const t=s,C=D,m=ve(),x=oe(),h=v(!1),n=v(""),u=v(!1),b=v(!1),g=v(null),y=v(null),S=L(()=>x.value&&x.value.id===t.reply.user_id),_=L(()=>t.reply.created_at!==t.reply.updated_at),d=L(()=>{var w;try{return Me(new Date(t.reply.created_at),{addSuffix:!0,locale:Te})}catch(M){return console.error("Error formatting date:",M),(w=t.reply.created_at)==null?void 0:w.toString()}}),i=L(()=>{var w;try{return new Date(t.reply.created_at).toLocaleString("ar-EG",{dateStyle:"long",timeStyle:"short"})}catch{return(w=t.reply.created_at)==null?void 0:w.toString()}}),f=async()=>{var w;S.value&&(h.value=!0,n.value=t.reply.content,g.value=null,await ue(),(w=y.value)==null||w.focus())},E=()=>{h.value=!1,n.value="",g.value=null},W=async()=>{if(!S.value||!n.value.trim()||u.value)return;const w=n.value.trim();if(w===t.reply.content){E();return}u.value=!0,g.value=null;try{const{data:M,error:N}=await m.from("comments").update({content:w,updated_at:new Date().toISOString()}).eq("id",t.reply.id).select("id, content, updated_at").single();if(N)throw N;if(!M)throw new Error("لم يتم إرجاع بيانات الرد المحدث.");C("replyUpdated",{...t.reply,content:M.content,updated_at:M.updated_at}),h.value=!1}catch(M){console.error("Error updating reply:",M),g.value=`فشل حفظ التعديل: (${M.message||"خطأ غير معروف"})`}finally{u.value=!1}},R=async()=>{if(!(!S.value||b.value)&&window.confirm("هل أنت متأكد من رغبتك في حذف هذا الرد؟")){b.value=!0;try{const{error:w}=await m.from("comments").delete().eq("id",t.reply.id);if(w)throw w;C("replyDeleted",t.reply.id)}catch(w){console.error("Error deleting reply:",w),alert(`فشل حذف الرد: (${w.message||"خطأ غير معروف"})`)}finally{b.value=!1}}};return(w,M)=>{var N,O,j;return o(),l("div",kt,[H(re,{"avatar-url":(N=w.reply.profiles)==null?void 0:N.avatar_url,name:(O=w.reply.profiles)==null?void 0:O.full_name,size:"sm",class:"mt-1"},null,8,["avatar-url","name"]),r("div",Ct,[r("div",St,[r("span",Mt,T(((j=w.reply.profiles)==null?void 0:j.full_name)||"مستخدم"),1),H(Ee,{item:w.reply,"item-type":"reply",onEdit:f,onDelete:R},null,8,["item"])]),r("div",Tt,[r("time",{datetime:w.reply.created_at,title:i.value},T(d.value),9,Et),_.value?(o(),l("span",Dt,"(تم التعديل)")):k("",!0)]),h.value?(o(),l("div",It,[G(r("textarea",{ref_key:"editInputRef",ref:y,"onUpdate:modelValue":M[0]||(M[0]=q=>n.value=q),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70",placeholder:"تعديل الرد...",disabled:u.value,onKeydown:[F(E,["esc"]),F(ee(W,["prevent","exact"]),["enter"])],"aria-label":"تعديل الرد"},null,40,Pt),[[ae,n.value]]),r("div",zt,[g.value?(o(),l("span",Lt,T(g.value),1)):k("",!0),r("button",{onClick:E,type:"button",disabled:u.value,class:"px-3 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600 dark:hover:bg-gray-600 disabled:opacity-50"}," إلغاء ",8,Rt),r("button",{onClick:W,type:"button",disabled:u.value||!n.value.trim(),class:"inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-white bg-primary-600 border border-transparent rounded-md shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[u.value?(o(),l("svg",Ht,M[1]||(M[1]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):k("",!0),r("span",null,T(u.value?"جاري الحفظ...":"حفظ"),1)],8,Wt)])])):(o(),l("p",$t,T(w.reply.content),1))])])}}}),Bt={class:"py-4"},qt={class:"flex space-x-3 rtl:space-x-reverse"},Ot={class:"flex-1 min-w-0"},jt={class:"flex items-center justify-between gap-2"},Ut={class:"text-sm font-semibold text-gray-900 dark:text-white truncate"},At={class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},Ft=["datetime","title"],Kt={key:0,class:"mx-1",title:"تم تعديل هذا التعليق"},Xt={key:0,class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words"},Vt={key:1},Yt=["disabled","onKeydown"],Gt={class:"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse"},Qt={key:0,class:"text-xs text-red-500 flex-1 text-right"},Jt=["disabled"],Zt=["disabled"],ea={key:0,class:"animate-spin ..."},ta={key:2,class:"mt-2 flex items-center space-x-4 rtl:space-x-reverse text-xs"},aa=["disabled","aria-expanded"],ra={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},na={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},oa={key:1,class:"text-yellow-600 dark:text-yellow-400"},sa=["aria-expanded"],la={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},ia={key:1,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},da={class:"mt-3 ml-10 rtl:mr-10 rtl:ml-0 pl-3 rtl:pr-3 border-l-2 border-gray-200 dark:border-gray-700 rtl:border-l-0 rtl:border-r-2"},ua=["id"],ca={class:"flex space-x-3 rtl:space-x-reverse"},ma={class:"flex-1 min-w-0"},va=["disabled","onKeydown"],fa={key:0,class:"mt-1 text-xs text-yellow-600 dark:text-yellow-400"},pa={class:"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse"},ya={key:0,class:"text-xs text-red-500 flex-1 text-right"},ha=["disabled"],ga=["disabled"],xa={key:0,class:"animate-spin ..."},wa=["id"],ba=ne({__name:"CommentItem",props:{comment:{type:Object,required:!0},replies:{type:Array,default:()=>[]},contentId:{type:Object,required:!0},isCommentingSuspended:{type:Boolean,default:!1}},emits:["commentUpdated","commentDeleted","replyAdded"],setup(s,{emit:D}){const t=s,C=D,m=ve(),x=oe(),{profile:h}=_e(ke()),n=v([]),u=v(!0),b=v(!1),g=v(""),y=v(!1),S=v(null),_=v(null),d=v(!1),i=v(""),f=v(!1),E=v(null),W=v(null),R=L(()=>x.value&&x.value.id===t.comment.user_id),w=L(()=>t.comment.created_at!==t.comment.updated_at),M=L(()=>{var a;try{return Me(new Date(t.comment.created_at),{addSuffix:!0,locale:Te})}catch(e){return console.error("Error formatting date:",e),(a=t.comment.created_at)==null?void 0:a.toString()}}),N=L(()=>{var a;try{return new Date(t.comment.created_at).toLocaleString("ar-EG",{dateStyle:"long",timeStyle:"short"})}catch{return(a=t.comment.created_at)==null?void 0:a.toString()}}),O=L(()=>[...n.value].sort((a,e)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime()));ce(()=>t.replies,a=>{n.value=[...a]},{deep:!0,immediate:!0});const j=async()=>{var a;R.value&&(b.value=!0,g.value=t.comment.content,S.value=null,d.value=!1,await ue(),(a=_.value)==null||a.focus())},q=()=>{b.value=!1,g.value="",S.value=null},U=async()=>{if(!R.value||!g.value.trim()||y.value)return;const a=g.value.trim();if(a===t.comment.content){q();return}y.value=!0,S.value=null;try{const{data:e,error:p}=await m.from("comments").update({content:a,updated_at:new Date().toISOString()}).eq("id",t.comment.id).select("id, content, updated_at").single();if(p)throw p;if(!e)throw new Error("لم يتم إرجاع بيانات التعليق المحدث.");C("commentUpdated",{...t.comment,content:e.content,updated_at:e.updated_at}),b.value=!1}catch(e){console.error("Error updating comment:",e),S.value=`فشل حفظ التعديل: (${e.message||"خطأ غير معروف"})`}finally{y.value=!1}},se=async()=>{if(R.value&&window.confirm("هل أنت متأكد من حذف هذا التعليق وكل ردوده؟"))try{const{error:a}=await m.from("comments").delete().eq("id",t.comment.id);if(a)throw a;C("commentDeleted",t.comment.id)}catch(a){console.error("Error deleting comment:",a),alert(`فشل حذف التعليق: (${a.message||"خطأ غير معروف"})`)}},Q=async()=>{var a;!x.value||t.isCommentingSuspended||(d.value=!d.value,i.value="",E.value=null,d.value&&(b.value=!1,await ue(),(a=W.value)==null||a.focus()))},J=()=>{d.value=!1,i.value="",E.value=null},Z=async()=>{if(t.isCommentingSuspended){E.value="لا يمكنك إضافة رد حاليًا بسبب الإيقاف.";return}if(!x.value||!h.value||!i.value.trim()||f.value)return;if(!h.value.id){E.value="خطأ: لم يتم العثور على معرف الملف الشخصي.",console.error("Profile ID missing");return}f.value=!0,E.value=null;const a={user_id:x.value.id,profile_id:h.value.id,content:i.value.trim(),parent_comment_id:t.comment.id,...t.contentId.lesson_id&&{lesson_id:Number(t.contentId.lesson_id)},...t.contentId.book_id&&{book_id:Number(t.contentId.book_id)},...t.contentId.study_course_id&&{study_course_id:Number(t.contentId.study_course_id)}};if(!a.lesson_id&&!a.book_id&&!a.study_course_id){E.value="خطأ: يجب ربط الرد بمحتوى.",console.error("Content ID missing"),f.value=!1;return}try{const{data:e,error:p}=await m.from("comments").insert(a).select("*, profiles!inner (id, full_name, avatar_url)").single();if(p)throw p;if(!e||!e.profiles)throw new Error("فشل جلب بيانات الرد الجديد.");C("replyAdded",e),i.value="",d.value=!1,u.value=!0}catch(e){console.error("Error adding reply:",e),E.value=`فشل إضافة الرد: (${e.message||"خطأ غير معروف"})`}finally{f.value=!1}},le=a=>{const e=n.value.findIndex(p=>p.id===a.id);e!==-1&&n.value.splice(e,1,a)},ie=a=>{n.value=n.value.filter(e=>e.id!==a)};return(a,e)=>{var p,c,P,z,$;return o(),l("div",Bt,[r("div",qt,[H(re,{"avatar-url":(p=s.comment.profiles)==null?void 0:p.avatar_url,name:(c=s.comment.profiles)==null?void 0:c.full_name,size:"md",class:"mt-1"},null,8,["avatar-url","name"]),r("div",Ot,[r("div",jt,[r("span",Ut,T(((P=s.comment.profiles)==null?void 0:P.full_name)||"مستخدم"),1),H(Ee,{item:s.comment,"item-type":"comment","is-commenting-suspended":s.isCommentingSuspended,onReply:Q,onEdit:j,onDelete:se,class:"flex-shrink-0"},null,8,["item","is-commenting-suspended"])]),r("div",At,[r("time",{datetime:s.comment.created_at,title:N.value},T(M.value),9,Ft),w.value?(o(),l("span",Kt,"(تم التعديل)")):k("",!0)]),b.value?(o(),l("div",Vt,[G(r("textarea",{ref_key:"editCommentInputRef",ref:_,"onUpdate:modelValue":e[0]||(e[0]=I=>g.value=I),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70",placeholder:"تعديل التعليق...",disabled:y.value,onKeydown:[F(q,["esc"]),F(ee(U,["prevent","exact"]),["enter"])],"aria-label":"تعديل التعليق"},null,40,Yt),[[ae,g.value]]),r("div",Gt,[S.value?(o(),l("span",Qt,T(S.value),1)):k("",!0),r("button",{onClick:q,type:"button",disabled:y.value,class:"px-3 py-1 text-xs ..."},"إلغاء",8,Jt),r("button",{onClick:U,type:"button",disabled:y.value||!g.value.trim(),class:"inline-flex ..."},[y.value?(o(),l("svg",ea)):k("",!0),r("span",null,T(y.value?"جاري الحفظ...":"حفظ"),1)],8,Zt)])])):(o(),l("p",Xt,T(s.comment.content),1)),b.value?k("",!0):(o(),l("div",ta,[B(x)?(o(),l("button",{key:0,onClick:Q,type:"button",class:"font-medium text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white inline-flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",disabled:s.isCommentingSuspended,"aria-controls":"reply-form-{{ comment.id }}","aria-expanded":d.value.toString()},[d.value?(o(),l("svg",na,e[4]||(e[4]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(o(),l("svg",ra,e[3]||(e[3]=[r("path",{"fill-rule":"evenodd",d:"M7.707 3.293a1 1 0 010 1.414L5.414 7H11a7 7 0 017 7v2a1 1 0 11-2 0v-2a5 5 0 00-5-5H5.414l2.293 2.293a1 1 0 11-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))),r("span",null,T(d.value?"إلغاء الرد":s.isCommentingSuspended?"الرد موقوف":"رد"),1)],8,aa)):k("",!0),s.isCommentingSuspended&&B(x)?(o(),l("span",oa,"(لا يمكنك الرد حاليًا)")):k("",!0),n.value.length>0?(o(),l("button",{key:2,onClick:e[1]||(e[1]=I=>u.value=!u.value),type:"button",class:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white flex items-center gap-1","aria-expanded":u.value.toString(),"aria-controls":"replies-list-{{ comment.id }}"},[u.value?(o(),l("svg",la,e[5]||(e[5]=[r("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},null,-1)]))):(o(),l("svg",ia,e[6]||(e[6]=[r("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]))),r("span",null,T(n.value.length)+" "+T(n.value.length===1?"رد":n.value.length===2?"ردان":n.value.length<=10?"ردود":"ردًا"),1)],8,sa)):k("",!0)]))])]),r("div",da,[d.value?(o(),l("div",{key:0,id:"reply-form-"+s.comment.id,class:"mb-4"},[r("div",ca,[H(re,{"avatar-url":(z=B(h))==null?void 0:z.avatar_url,name:($=B(h))==null?void 0:$.full_name,size:"sm",class:"mt-1"},null,8,["avatar-url","name"]),r("div",ma,[G(r("textarea",{ref_key:"replyInputRef",ref:W,"onUpdate:modelValue":e[2]||(e[2]=I=>i.value=I),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70",placeholder:"إضافة رد عام...",disabled:f.value||s.isCommentingSuspended,onKeydown:[F(J,["esc"]),F(ee(Z,["prevent","exact"]),["enter"])],"aria-label":"إضافة رد جديد"},null,40,va),[[ae,i.value]]),s.isCommentingSuspended?(o(),l("p",fa," لا يمكنك إضافة رد حاليًا بسبب الإيقاف. ")):k("",!0),r("div",pa,[E.value?(o(),l("span",ya,T(E.value),1)):k("",!0),r("button",{onClick:J,type:"button",disabled:f.value,class:"px-3 py-1 text-xs ..."},"إلغاء",8,ha),r("button",{onClick:Z,type:"button",disabled:f.value||!i.value.trim()||s.isCommentingSuspended,class:"inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-white bg-primary-600 border border-transparent rounded-md shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[f.value?(o(),l("svg",xa)):k("",!0),r("span",null,T(f.value?"جاري الرد...":"رد"),1)],8,ga)])])])],8,ua)):k("",!0),H(be,{name:"fade"},{default:te(()=>[G(r("div",{id:"replies-list-"+s.comment.id,class:"space-y-0"},[(o(!0),l(me,null,Ce(O.value,I=>(o(),Se(Nt,{key:I.id,reply:I,onReplyUpdated:le,onReplyDeleted:ie},null,8,["reply"]))),128))],8,wa),[[Pe,n.value.length>0&&u.value]])]),_:1})])])}}}),_a=ze(ba,[["__scopeId","data-v-81392211"]]),ka={class:"mt-8 py-6 border-t border-gray-200 dark:border-gray-700"},Ca={class:"text-xl font-semibold mb-4 text-gray-900 dark:text-white"},Sa={key:0,class:"mb-6"},Ma={class:"flex space-x-3 rtl:space-x-reverse"},Ta={class:"flex-1 min-w-0"},Ea=["disabled"],Da={key:0,class:"mt-1 text-xs text-yellow-600 dark:text-yellow-400"},$a={class:"mt-2 flex items-center justify-end space-x-2 rtl:space-x-reverse"},Ia={key:0,class:"text-xs text-red-500 flex-1 text-right"},Pa=["disabled"],za={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},La={key:1,class:"mb-6 p-4 text-center bg-gray-100 dark:bg-gray-800 rounded-md"},Ra={class:"text-sm text-gray-700 dark:text-gray-300"},Wa={key:2,class:"text-center py-10"},Ha={key:3,class:"text-center py-6 text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 rounded-md p-4"},Na={key:4,class:"text-center py-10 text-gray-500 dark:text-gray-400"},Ba={key:5,class:"space-y-4"},qa={key:0,class:"text-center pt-4"},Oa=["disabled"],ja={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ua={key:0,class:"mt-2 text-xs text-red-500"},Ga=ne({__name:"CommentSection",props:{lessonId:{},bookId:{},courseId:{}},setup(s){const D=a=>a,t=s,C=ve(),m=oe(),x=ke(),{profile:h}=_e(x),n=v([]),u=v(null),b=v(!0),g=v(!1),y=v(null),S=v(null),_=v(10),d=v(1),i=v(!0),f=v(""),E=v(!1),W=v(null),R=L(()=>t.lessonId!==void 0?{column:"lesson_id",value:Number(t.lessonId)}:t.bookId!==void 0?{column:"book_id",value:Number(t.bookId)}:t.courseId!==void 0?{column:"study_course_id",value:Number(t.courseId)}:null),w=L(()=>({lesson_id:t.lessonId,book_id:t.bookId,study_course_id:t.courseId})),M=L(()=>{const a=x.profile;if(!a||!a.comment_suspended_until)return!1;try{return new Date(a.comment_suspended_until)>new Date}catch{return!1}}),N=L(()=>n.value.filter(a=>a.parent_comment_id===null).sort((a,e)=>new Date(e.created_at).getTime()-new Date(a.created_at).getTime())),O=a=>n.value.filter(e=>e.parent_comment_id===a),j=async(a,e)=>{try{const{count:p,error:c}=await C.from("comments").select("*",{count:"exact",head:!0}).eq(a,e).eq("is_approved",!0);if(c)throw c;return p??0}catch(p){return console.error("Error fetching total comments count:",p),y.value="فشل في جلب عدد التعليقات.",null}},q=async(a,e,p=1)=>{const c=(p-1)*_.value,P=c+_.value-1,{data:z,error:$}=await C.from("comments").select(`
      *,
      profiles!inner (id, full_name, avatar_url)
    `).eq(a,e).eq("is_approved",!0).is("parent_comment_id",null).order("created_at",{ascending:!1}).range(c,P);if($)throw $;const I=(z||[]).filter(K=>K.profiles!==null),A=I.map(K=>K.id);let fe=[];if(A.length>0){const{data:K,error:pe}=await C.from("comments").select(`
        *,
        profiles!inner (id, full_name, avatar_url)
      `).in("parent_comment_id",A).eq("is_approved",!0).order("created_at",{ascending:!0});pe?(console.error("Error fetching replies:",pe),S.value="حدث خطأ أثناء تحميل بعض الردود."):fe=(K||[]).filter(De=>De.profiles!==null)}return{newTopLevelComments:I,repliesData:fe}},U=async()=>{if(b.value=!0,y.value=null,n.value=[],d.value=1,i.value=!0,u.value=null,[t.lessonId,t.bookId,t.courseId].filter(c=>c!==void 0).length!==1||!R.value){y.value="خطأ في إعداد المكون: يجب تحديد معرف محتوى واحد فقط.",b.value=!1,i.value=!1;return}const{column:e,value:p}=R.value;try{const c=await j(e,p);if(c===null){b.value=!1,i.value=!1;return}if(u.value=c,u.value===0)i.value=!1,n.value=[];else{const{newTopLevelComments:P,repliesData:z}=await q(e,p,1),$=[...P,...z],I=new Set;$.forEach(A=>{I.has(A.id)||(n.value.push(A),I.add(A.id))}),i.value=P.length===_.value}}catch(c){console.error("Error fetching initial comments:",c),y.value=`فشل تحميل التعليقات: (${c.message||"خطأ غير معروف"})`,n.value=[],u.value=0,i.value=!1}finally{b.value=!1}},se=async()=>{if(!i.value||g.value||!R.value)return;g.value=!0,S.value=null;const a=d.value+1,{column:e,value:p}=R.value;try{const{newTopLevelComments:c,repliesData:P}=await q(e,p,a);if(c.length===0)i.value=!1;else{const z=[...c,...P],$=new Set(n.value.map(I=>I.id));z.forEach(I=>{$.has(I.id)||(n.value.push(I),$.add(I.id))}),d.value=a,i.value=c.length===_.value}}catch(c){console.error("Error loading more comments:",c),S.value=`فشل تحميل المزيد: (${c.message||"خطأ غير معروف"})`}finally{g.value=!1}},Q=async()=>{if(M.value){W.value="لا يمكنك إضافة تعليق حاليًا بسبب الإيقاف.";return}if(!m.value||!h.value||!f.value.trim()||!R.value||E.value)return;if(!h.value.id){W.value="خطأ: لم يتم العثور على معرف الملف الشخصي.",console.error("Profile ID is missing from user store");return}E.value=!0,W.value=null;const{column:a,value:e}=R.value,p={user_id:m.value.id,profile_id:h.value.id,content:f.value.trim(),parent_comment_id:null,[a]:e};try{const{data:c,error:P}=await C.from("comments").insert(p).select("*, profiles!inner (id, full_name, avatar_url)").single();if(P)throw P;if(!c||!c.profiles)throw new Error("لم يتم إرجاع بيانات التعليق الجديد أو الملف الشخصي.");n.value.unshift(c),f.value="",u.value!==null&&u.value++}catch(c){console.error("Error adding comment:",c),W.value=`فشل إضافة التعليق: (${c.message||"يرجى المحاولة مرة أخرى"})`}finally{E.value=!1}},J=a=>{const e=n.value.findIndex(p=>p.id===a.id);e!==-1&&n.value.splice(e,1,a)},Z=a=>{const e=new Set([a]),p=z=>{n.value.forEach($=>{$.parent_comment_id===z&&(e.add($.id),p($.id))})};p(a);const c=n.value.length;n.value=n.value.filter(z=>!e.has(z.id));const P=c-n.value.length;u.value!==null&&P>0&&(u.value=Math.max(0,u.value-P))},le=a=>{n.value.some(e=>e.id===a.id)||(n.value.push(a),u.value!==null&&u.value++)},ie=a=>{if(!a)return"";try{const e=new Date(a);return isNaN(e.getTime())?"":e.toLocaleString("ar-EG",{dateStyle:"short",timeStyle:"short",hour12:!0})}catch{return""}};return Le(()=>{U()}),ce(R,(a,e)=>{((a==null?void 0:a.value)!==(e==null?void 0:e.value)||(a==null?void 0:a.column)!==(e==null?void 0:e.column))&&(a?U():(n.value=[],u.value=0,y.value="خطأ في إعداد المكون: لم يتم تحديد معرف محتوى.",b.value=!1,i.value=!1))},{immediate:!1}),(a,e)=>{var c,P,z;const p=$e;return o(),l("section",ka,[r("h2",Ca," التعليقات ("+T(u.value??"...")+") ",1),B(m)?(o(),l("div",Sa,[r("div",Ma,[H(re,{"avatar-url":(c=B(h))==null?void 0:c.avatar_url,name:(P=B(h))==null?void 0:P.full_name,size:"md",class:"flex-shrink-0 mt-1"},null,8,["avatar-url","name"]),r("div",Ta,[G(r("textarea",{"onUpdate:modelValue":e[0]||(e[0]=$=>f.value=$),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-800 dark:border-gray-600 dark:text-white disabled:opacity-70",placeholder:"إضافة تعليق عام...",disabled:E.value||M.value,"aria-label":"إضافة تعليق جديد"},null,8,Ea),[[ae,f.value]]),M.value?(o(),l("p",Da," التعليق موقوف حاليًا حتى "+T(ie((z=B(x).profile)==null?void 0:z.comment_suspended_until))+". ",1)):k("",!0),r("div",$a,[W.value?(o(),l("span",Ia,T(W.value),1)):k("",!0),r("button",{onClick:Q,type:"button",disabled:E.value||!f.value.trim()||M.value,class:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[E.value?(o(),l("svg",za,e[1]||(e[1]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):k("",!0),r("span",null,T(E.value?"جاري الإضافة...":M.value?"التعليق موقوف":"إضافة تعليق"),1)],8,Pa)])])])])):(o(),l("div",La,[r("p",Ra,[e[4]||(e[4]=X(" يرجى ")),H(p,{to:D("/login"),class:"text-primary-600 hover:underline dark:text-primary-400 font-medium"},{default:te(()=>e[2]||(e[2]=[X("تسجيل الدخول")])),_:1},8,["to"]),e[5]||(e[5]=X(" أو ")),H(p,{to:D("/signup"),class:"text-primary-600 hover:underline dark:text-primary-400 font-medium"},{default:te(()=>e[3]||(e[3]=[X("إنشاء حساب")])),_:1},8,["to"]),e[6]||(e[6]=X(" للتعليق. "))])])),b.value?(o(),l("div",Wa,[H(je,{class:"mx-auto h-8 w-8 text-gray-500 dark:text-gray-400"}),e[7]||(e[7]=r("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},"جاري تحميل التعليقات...",-1))])):y.value?(o(),l("div",Ha,[e[8]||(e[8]=r("svg",{class:"w-6 h-6 inline-block mb-1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),r("p",null,T(y.value),1),y.value.includes("إعداد المكون")?k("",!0):(o(),l("button",{key:0,onClick:U,class:"mt-2 px-3 py-1 text-xs font-medium text-primary-700 dark:text-primary-300 hover:underline"},"إعادة المحاولة"))])):n.value.length===0&&u.value===0?(o(),l("div",Na,e[9]||(e[9]=[r("svg",{class:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1),r("p",{class:"text-lg font-medium"},"لا توجد تعليقات بعد",-1),r("p",{class:"text-sm mt-1"},"كن أول من يترك تعليقاً!",-1)]))):(o(),l("div",Ba,[(o(!0),l(me,null,Ce(N.value,$=>(o(),Se(_a,{key:$.id,comment:$,replies:O($.id),"content-id":w.value,"is-commenting-suspended":M.value,onCommentUpdated:J,onCommentDeleted:Z,onReplyAdded:le,class:"border-b border-gray-200 dark:border-gray-700 last:border-b-0 pb-4"},null,8,["comment","replies","content-id","is-commenting-suspended"]))),128)),i.value?(o(),l("div",qa,[r("button",{onClick:se,disabled:g.value,class:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-primary-700 bg-primary-100 border border-transparent rounded-md hover:bg-primary-200 dark:text-primary-300 dark:bg-primary-900 dark:hover:bg-primary-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},[g.value?(o(),l("svg",ja,e[10]||(e[10]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):k("",!0),r("span",null,T(g.value?"جاري التحميل...":"تحميل المزيد من التعليقات"),1)],8,Oa),S.value?(o(),l("p",Ua,T(S.value),1)):k("",!0)])):k("",!0)]))])}}});export{Ga as _};
