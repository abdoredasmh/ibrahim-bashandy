const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CgliSXAb.js","./C2nUyU-9.js","./CaF1xe-H.js","./entry.DgcQJhFP.css","./CpjGp_h0.js","./LoadingSpinner.Dre-g5PP.css","./vWwLff75.js","./PdfViewerModal.Dt6jtUpO.css"])))=>i.map(i=>d[i]);
import{e as ke,C as Ce,u as $e,E as Le,a0 as Ie,g as R,a2 as w,r as C,f as Me,l as ae,c as a,b as m,h as x,a as s,t as g,w as c,i as $,p as ee,F as Pe,j as Ee,V as U,a3 as Q,o,d as L,W as Ae,X as Be,_ as Ze}from"./CaF1xe-H.js";import{_ as qe}from"./CEyFpblA.js";import{_ as ze}from"./C2nUyU-9.js";import{L as se}from"./CpjGp_h0.js";import{_ as Se}from"./BFvDSq9n.js";import{u as Te}from"./CqvecxAQ.js";import{u as Ne}from"./C0vmt3Ib.js";import"./Cjm1-dYk.js";import"./Bqepao4b.js";import"./DhpZqJBn.js";const Re={class:"container mx-auto px-4 py-8"},Ve={key:0,class:"text-center py-20"},Fe={key:1,class:"text-center py-20 max-w-2xl mx-auto"},He={class:"text-2xl font-semibold text-red-600 dark:text-red-400 mb-4"},De={key:2,class:"lesson-details max-w-5xl mx-auto space-y-6"},Oe={key:0,class:"mb-4 text-sm text-center md:text-right"},Ue={class:"text-3xl font-bold text-brown-dark dark:text-brown-dark text-center sm:text-right"},Qe={class:"video-section flex items-center gap-2 sm:gap-4"},je={class:"flex-shrink-0"},Ge={key:1,class:"nav-placeholder","aria-hidden":"true"},We={class:"flex-grow min-w-0"},Xe={key:0,class:"relative w-full rounded-lg overflow-hidden shadow-lg bg-black aspect-video"},Ye=["src"],Je={key:1,class:"video-error-box p-4 bg-yellow-100 dark:bg-yellow-900 border border-yellow-300 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200 rounded-md"},Ke={class:"block break-all mt-1 text-xs bg-yellow-200 dark:bg-yellow-800 px-1 rounded"},es={key:2,class:"video-error-box p-4 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 rounded-md"},ss={class:"flex-shrink-0"},ts={key:1,class:"nav-placeholder","aria-hidden":"true"},ls={class:"action-buttons-section text-center mt-6 space-y-4"},os={key:0},rs={class:"completion-status"},as=["disabled"],ns={key:0},is={key:1,class:"inline-flex items-center"},ds={key:1,class:"inline-flex items-center px-4 py-2 border border-green-300 dark:border-green-700 rounded-md text-sm font-medium text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/30"},us={key:2,class:"text-xs text-red-500 dark:text-red-400 mt-2"},cs={key:0,class:"quiz-link mt-4"},vs={key:1,class:"enroll-prompt p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg max-w-md mx-auto"},ms=["disabled"],ps={key:0},gs={key:1},fs={key:0,class:"text-xs text-red-500 dark:text-red-400 mt-1"},ys={key:2,class:"login-prompt p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg max-w-md mx-auto"},xs={key:1,class:"description-section pt-6 border-t border-gray-200 dark:border-gray-700"},hs={class:"prose prose-lg dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},_s={key:2,class:"description-section pt-6 border-t border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 italic"},ws={key:3,class:"downloads-section p-5 bg-beige-light dark:bg-cream-gray rounded-lg shadow-sm border border-cream-gray dark:border-gray-700"},bs={class:"flex flex-col sm:flex-row items-start sm:items-center gap-3 flex-wrap"},ks=["onClick"],Cs={class:"text-xs opacity-75"},$s={key:1,class:"inline-flex items-center gap-1 text-xs text-gray-400 dark:text-gray-500 italic px-4 py-2"},Ls=ke({__name:"[lessonId]",async setup(Is){let V,te;const ne=Ae(()=>Be(()=>import("./CgliSXAb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),b=Ce(),p=$e(),ie=Le(),{profile:f,isLoggedIn:h}=Ie(ie);console.log(`--- LESSON PAGE [${b.params.lessonId}] SETUP STARTED ---`);const v=R(()=>{const t=b.params.courseId;if(!t)return Q({statusCode:400,statusMessage:"معرف الدورة مفقود من الرابط.",fatal:!0}),null;const e=parseInt(t,10);return isNaN(e)||e<=0?(Q({statusCode:400,statusMessage:`معرف الدورة غير صالح: "${t}"`,fatal:!0}),null):e}),j=R(()=>{const t=b.params.lessonId;if(!t)return Q({statusCode:400,statusMessage:"معرف الدرس مفقود من الرابط.",fatal:!0}),null;const e=parseInt(t,10);return isNaN(e)||e<=0?(Q({statusCode:400,statusMessage:`معرف الدرس غير صالح: "${t}"`,fatal:!0}),null):e}),d=w(null),A=w([]),B=w(null),Z=w(null),I=w(null),M=w(null),F=w(null),H=w(null),q=C(!1),D=C(null),z=C(!1),S=C(null),G=C(!1),W=C(null),X=C(null);(v.value===null||j.value===null)&&console.error("Lesson Page Setup: Halting due to invalid route parameters detected earlier.");const{data:de,pending:Y,error:T,refresh:ue}=([V,te]=Me(async()=>{var t;return Te(`lessonData-${v.value}-${j.value}-${((t=f.value)==null?void 0:t.id)??"guest"}`,async()=>{var u;const e=j.value,l=v.value,r=(u=f.value)==null?void 0:u.id;if(l===null||e===null)throw console.error("Fetcher Error: Invalid course or lesson ID at fetch time."),U({statusCode:400,statusMessage:"المعرفات المطلوبة غير صالحة لجلب البيانات.",fatal:!0});console.log(`--- Fetching lesson data for Course ${l}, Lesson ${e}, User ${r||"Guest"} ---`);try{const{data:i,error:y}=await p.from("lessons").select("*, course:study_courses!inner (id, title, is_active)").eq("id",e).eq("course_id",l).eq("course.is_active",!0).maybeSingle();if(y)throw console.error("DB Error fetching lesson/course:",y),U({statusCode:500,statusMessage:`خطأ في جلب بيانات الدرس الرئيسية: ${y.message}`,fatal:!0});if(!i)throw console.warn(`Lesson ${e} not found in active course ${l}, or course inactive.`),U({statusCode:404,statusMessage:"الدرس المطلوب غير موجود أو لا ينتمي لدورة نشطة.",fatal:!0});const n=i,k=i.course,_=n.lesson_order,fe=[p.from("books").select("*").eq("linked_lesson_id",e),_!==null?p.from("lessons").select("id, title").eq("course_id",l).lt("lesson_order",_).order("lesson_order",{ascending:!1}).limit(1).maybeSingle():Promise.resolve({data:null,error:null}),_!==null?p.from("lessons").select("id, title").eq("course_id",l).gt("lesson_order",_).order("lesson_order",{ascending:!0}).limit(1).maybeSingle():Promise.resolve({data:null,error:null}),h.value&&r?p.from("lesson_completions").select("lesson_id").eq("user_id",r).eq("lesson_id",e).maybeSingle():Promise.resolve({data:null,error:null}),h.value&&r?p.from("course_enrollments").select("*").eq("user_id",r).eq("course_id",l).maybeSingle():Promise.resolve({data:null,error:null}),p.from("quizzes").select("id, title, is_active").eq("lesson_id",e).eq("type","lesson").eq("is_active",!0).maybeSingle()],ye=await Promise.allSettled(fe),P=(O,re,K)=>{const N=ye[O];return N.status==="fulfilled"?N.value.error?(console.error(`Supabase Error fetching ${re}:`,N.value.error.message),K):N.value.data??K:(console.error(`Failed fetching ${re} (Promise rejected):`,N.reason),K)},xe=P(0,"linked books",[]),he=P(1,"previous lesson",null),_e=P(2,"next lesson",null),we=P(3,"completion status",null),E=P(4,"enrollment status",null),be=P(5,"lesson quiz",null);return E!=null&&E.id&&n.id?(console.log(`Attempting to update last accessed lesson for enrollment ${E.id} to lesson ${n.id}`),p.from("course_enrollments").update({last_accessed_lesson_id:n.id,updated_at:new Date().toISOString()}).eq("id",E.id).then(({error:O})=>{O?console.error("Failed to update last_accessed_lesson_id:",O.message):console.log("Successfully updated last_accessed_lesson_id.")})):h.value&&n.id&&console.log("User is logged in but not enrolled in this course, skipping last_accessed_lesson update."),console.log("--- Lesson data fetch successful ---"),{lesson:n,linkedBooks:xe,previousLesson:he,nextLesson:_e,courseInfo:k,lessonCompletion:we,enrollment:E,lessonQuiz:be}}catch(i){throw console.error("!!! CRITICAL ERROR in useAsyncData lesson fetch !!!:",i),i.statusCode&&i.fatal?i:U({statusCode:i.statusCode||500,statusMessage:`حدث خطأ غير متوقع أثناء تحميل بيانات الدرس: ${i.message||"خطأ غير معروف"}`,fatal:!0})}},{default:()=>({lesson:null,linkedBooks:[],previousLesson:null,nextLesson:null,courseInfo:null,lessonCompletion:null,enrollment:null,lessonQuiz:null}),watch:[()=>{var e;return(e=f.value)==null?void 0:e.id},()=>b.params.lessonId,()=>b.params.courseId]})}),V=await V,te(),V);ae(de,t=>{console.log("Lesson page useAsyncData watcher triggered. New data received:",!!t),t?(d.value=t.lesson,A.value=t.linkedBooks,B.value=t.previousLesson,Z.value=t.nextLesson,I.value=t.courseInfo,M.value=t.lessonCompletion,F.value=t.enrollment,H.value=t.lessonQuiz):!Y.value&&!T.value&&(d.value=null,A.value=[],B.value=null,Z.value=null,I.value=null,M.value=null,F.value=null,H.value=null)},{immediate:!0});const J=R(()=>!!F.value),le=R(()=>!!M.value),oe=R(()=>{var e;const t=(e=d.value)==null?void 0:e.youtube_url;if(!t)return null;try{const l=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/|v\/|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})(?:\S+)?/,r=t.match(l);return r&&r[1]?r[1]:null}catch(l){return console.error("Error parsing YouTube URL:",t,l),null}});async function ce(){var t,e;if(!(!h.value||!((t=f.value)!=null&&t.id)||!((e=d.value)!=null&&e.id)||le.value||q.value)){q.value=!0,D.value=null,console.log(`Attempting to mark lesson ${d.value.id} as complete for user ${f.value.id}`);try{const{data:l,error:r}=await p.from("lesson_completions").insert({user_id:f.value.id,lesson_id:d.value.id}).select("lesson_id").single();if(r)if(r.code==="23505")console.warn("Lesson already marked complete in DB, syncing local state."),M.value||(M.value={lesson_id:d.value.id});else throw r;else l&&(M.value=l,console.log("Lesson successfully marked complete!"))}catch(l){console.error("Error marking lesson complete:",l),D.value=`فشل تحديث الحالة: ${l.message||"حدث خطأ غير متوقع."}`}finally{q.value=!1}}}async function ve(t){var e;if(!(t===null||!h.value||!((e=f.value)!=null&&e.id)||J.value||z.value)){z.value=!0,S.value=null,console.log(`Attempting to enroll user ${f.value.id} in course ${t}`);try{const{data:l,error:r}=await p.from("course_enrollments").insert({user_id:f.value.id,course_id:t}).select("*").single();if(r)if(r.code==="23505")console.warn("Enrollment conflict detected. Refreshing data."),await ue();else throw r;else l&&(F.value=l,console.log("Enrollment successful!"),alert("تم الانتساب بنجاح!"))}catch(l){console.error("Enrollment error on lesson page:",l),S.value=`فشل الانتساب: ${l.message||"حدث خطأ غير متوقع."}`,alert(S.value)}finally{z.value=!1}}}function me(t,e){t?(W.value=t,X.value=e||"ملف مرتبط",G.value=!0,console.log(`Opening PDF modal for path: ${t}`)):console.warn("Attempted to open PDF modal with no path for book:",e)}function pe(){G.value=!1,W.value=null,X.value=null,console.log("PDF modal closed.")}function ge(t){return t!=null&&t.is_research&&(t!=null&&t.is_transcript)?"بحث وتفريغ":t!=null&&t.is_research?"بحث":t!=null&&t.is_transcript?"تفريغ":"كتاب"}return ae([d,I,Y,T],([t,e,l,r])=>{var y;let u="تفاصيل الدرس",i="عرض تفاصيل الدرس والمحتوى المرتبط به ضمن دورات الشيخ.";if(l)u="جارٍ تحميل الدرس...",i="يتم الآن تحميل بيانات الدرس.";else if(r||!t)u="الدرس غير متاح",i=((y=r==null?void 0:r.data)==null?void 0:y.statusMessage)||(r==null?void 0:r.message)||"لم يتم العثور على الدرس المطلوب أو حدث خطأ.";else{const n=t.title||"درس بدون عنوان",k=e==null?void 0:e.title;u=k?`${n} - ${k}`:n;const _=t.description;_?i=_.substring(0,160).trim()+(_.length>160?"...":""):i=`شاهد درس "${n}"${k?` ضمن دورة "${k}"`:""}.`}Ne({title:u,meta:[{name:"description",content:i},{property:"og:title",content:u},{property:"og:description",content:i},{property:"og:type",content:"video.other"},{property:"og:url",content:b.fullPath},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:u},{name:"twitter:description",content:i}]})},{immediate:!0}),(t,e)=>{var u,i,y;const l=qe,r=ze;return o(),a("div",Re,[x(Y)?(o(),a("div",Ve,[m(se),e[1]||(e[1]=s("p",{class:"mt-4 text-gray-600 dark:text-gray-400"},"جارٍ تحميل بيانات الدرس...",-1))])):x(T)||!d.value?(o(),a("div",Fe,[s("h2",He,g(((i=(u=x(T))==null?void 0:u.data)==null?void 0:i.statusMessage)||((y=x(T))==null?void 0:y.message)||"خطأ في الوصول للدرس"),1),e[3]||(e[3]=s("p",{class:"text-gray-600 dark:text-gray-400 mb-6"}," لم نتمكن من العثور على الدرس المطلوب ضمن هذه الدورة، أو أن الدورة غير نشطة، أو أنك لا تملك صلاحية الوصول إليه. يرجى التأكد من الرابط أو العودة للدورة. ",-1)),m(l,{to:v.value?`/study/courses/${v.value}`:"/study",class:"inline-flex items-center justify-center px-6 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-olive-green hover:bg-opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-olive-green"},{default:c(()=>e[2]||(e[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 ms-2","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.25-7.25a.75.75 0 0 0 0-1.5H8.66l2.1-1.95a.75.75 0 1 0-1.02-1.1l-3.5 3.25a.75.75 0 0 0 0 1.1l3.5 3.25a.75.75 0 0 0 1.02-1.1l-2.1-1.95h4.59Z","clip-rule":"evenodd"})],-1),s("span",null,"العودة للدورة",-1)])),_:1},8,["to"])])):(o(),a("div",De,[I.value?(o(),a("div",Oe,[m(l,{to:`/study/courses/${I.value.id}`,class:"text-gray-600 dark:text-gray-400 hover:text-olive-green transition-colors duration-200"},{default:c(()=>[L(" دورة: "+g(I.value.title),1)]),_:1},8,["to"])])):$("",!0),s("h1",Ue,g(d.value.title||"درس بدون عنوان"),1),s("div",Qe,[s("div",je,[B.value&&v.value?(o(),ee(l,{key:0,to:`/study/courses/${v.value}/lessons/${B.value.id}`,class:"nav-button",title:`الدرس السابق: ${B.value.title}`,"aria-label":"الدرس السابق"},{default:c(()=>e[4]||(e[4]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"nav-icon","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})],-1)])),_:1},8,["to","title"])):(o(),a("div",Ge))]),s("div",We,[oe.value?(o(),a("div",Xe,[s("iframe",{src:`https://www.youtube.com/embed/${oe.value}`,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:"",class:"absolute inset-0 w-full h-full",title:"مشغل فيديو الدرس","aria-label":"مشغل فيديو الدرس"},null,8,Ye)])):d.value.youtube_url?(o(),a("div",Je,[e[5]||(e[5]=s("p",{class:"font-semibold"},"رابط يوتيوب غير صالح أو غير متوفر.",-1)),e[6]||(e[6]=s("p",{class:"mt-1 text-sm"},"الرجاء التأكد من أن الرابط في قاعدة البيانات هو رابط يوتيوب صحيح (مثل youtube.com/watch?v=... أو youtu.be/... أو youtube.com/embed/... أو youtube.com/shorts/...).",-1)),e[7]||(e[7]=s("p",{class:"mt-1 text-sm"},"الرابط المسجل حالياً:",-1)),s("code",Ke,g(d.value.youtube_url),1)])):(o(),a("div",es,e[8]||(e[8]=[s("p",null,"لا يوجد رابط فيديو متاح لهذا الدرس.",-1)])))]),s("div",ss,[Z.value&&v.value?(o(),ee(l,{key:0,to:`/study/courses/${v.value}/lessons/${Z.value.id}`,class:"nav-button",title:`الدرس التالي: ${Z.value.title}`,"aria-label":"الدرس التالي"},{default:c(()=>e[9]||(e[9]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"nav-icon","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1)])),_:1},8,["to","title"])):(o(),a("div",ts))])]),m(r,null,{fallback:c(()=>e[18]||(e[18]=[s("div",{class:"text-center mt-6 h-16 bg-gray-100 dark:bg-gray-800 animate-pulse rounded-md max-w-xs mx-auto"},null,-1)])),default:c(()=>[s("div",ls,[x(h)&&J.value?(o(),a("div",os,[s("div",rs,[le.value?(o(),a("div",ds,e[12]||(e[12]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 me-2","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M16.403 12.652a3 3 0 0 0 0-5.304 3 3 0 0 0-3.75-3.751 3 3 0 0 0-5.305 0 3 3 0 0 0-3.751 3.75 3 3 0 0 0 0 5.305 3 3 0 0 0 3.75 3.751 3 3 0 0 0 5.305 0 3 3 0 0 0 3.751-3.75Zm-2.546-4.46a.75.75 0 0 0-1.214-.883l-3.48 4.774L6.52 10.91a.75.75 0 1 0-1.04 1.08l2.18 2.108a.75.75 0 0 0 1.076-.015l4.145-5.682Z","clip-rule":"evenodd"})],-1),L(" تم إكمال هذا الدرس ")]))):(o(),a("button",{key:0,onClick:ce,disabled:q.value,class:"button-complete"},[q.value?(o(),a("span",ns,[m(se,{class:"w-5 h-5 inline me-2 animate-spin","aria-hidden":"true"}),e[10]||(e[10]=L(" جاري التحديث... "))])):(o(),a("span",is,e[11]||(e[11]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 me-1","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z","clip-rule":"evenodd"})],-1),L(" تمييز الدرس كمكتمل ")])))],8,as)),D.value?(o(),a("p",us,g(D.value),1)):$("",!0)]),H.value?(o(),a("div",cs,[m(l,{to:`/quizzes/${H.value.id}`,class:"button-quiz inline-flex items-center justify-center px-5 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-muted hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-muted dark:bg-blue-muted dark:hover:opacity-90 dark:focus:ring-offset-gray-800 dark:text-gray-900 transition-opacity duration-150 ease-in-out"},{default:c(()=>e[13]||(e[13]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 me-1","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M15.962 2.61a.75.75 0 0 0-.61-.21L4.04 4.357a.75.75 0 0 0-.61.846l.727 3.474a.75.75 0 0 0 .756.623H6.75V13a.75.75 0 0 0 .75.75h5.5a.75.75 0 0 0 .75-.75V9.3H15.5a.75.75 0 0 0 .756-.623l.727-3.474a.75.75 0 0 0-.021-.592Zm-1.02 4.04-.484 2.31H7.5v-2.7l7.958-1.307.484 2.31Z","clip-rule":"evenodd"}),s("path",{d:"M4.5 10.5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),s("path",{d:"M15.5 10.5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"})],-1),s("span",null,"ابدأ اختبار الدرس",-1)])),_:1},8,["to"])])):$("",!0)])):x(h)&&!J.value&&v.value?(o(),a("div",vs,[e[15]||(e[15]=s("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"},"يجب الانتساب للدورة أولاً لتتمكن من تتبع تقدمك وتقديم الاختبارات.",-1)),s("button",{onClick:e[0]||(e[0]=n=>ve(v.value)),disabled:z.value,class:"button-enroll mt-3"},[z.value?(o(),a("span",ps,[m(se,{class:"w-5 h-5 inline me-2 animate-spin","aria-hidden":"true"}),e[14]||(e[14]=L(" جاري الانتساب... "))])):(o(),a("span",gs,"انتسب للدورة الآن"))],8,ms),S.value?(o(),a("p",fs,g(S.value),1)):$("",!0)])):x(h)?$("",!0):(o(),a("div",ys,[e[17]||(e[17]=s("p",{class:"text-sm text-blue-800 dark:text-blue-200 mb-3"},"سجل الدخول أو أنشئ حساباً لتتمكن من الانتساب لهذه الدورة وتتبع تقدمك.",-1)),m(l,{to:`/login?redirect=${x(b).fullPath}`,class:"button-login"},{default:c(()=>e[16]||(e[16]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 me-1","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M3 4.25A2.25 2.25 0 0 1 5.25 2h5.5A2.25 2.25 0 0 1 13 4.25v2a.75.75 0 0 1-1.5 0v-2a.75.75 0 0 0-.75-.75h-5.5a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 0 0 .75-.75v-2a.75.75 0 0 1 1.5 0v2A2.25 2.25 0 0 1 10.75 18h-5.5A2.25 2.25 0 0 1 3 15.75V4.25Z","clip-rule":"evenodd"}),s("path",{"fill-rule":"evenodd",d:"M6 10a.75.75 0 0 1 .75-.75h9.546l-1.048-.943a.75.75 0 1 1 1.004-1.114l2.5 2.25a.75.75 0 0 1 0 1.114l-2.5 2.25a.75.75 0 1 1-1.004-1.114l1.048-.943H6.75A.75.75 0 0 1 6 10Z","clip-rule":"evenodd"})],-1),L(" تسجيل الدخول / إنشاء حساب ")])),_:1},8,["to"])]))])]),_:1}),d.value.description?(o(),a("div",xs,[e[19]||(e[19]=s("h2",{class:"text-2xl font-semibold text-brown-dark dark:text-beige-light mb-3"},"عن الدرس:",-1)),s("div",hs,g(d.value.description),1)])):(o(),a("div",_s,"لا يوجد وصف متاح لهذا الدرس.")),A.value&&A.value.length>0?(o(),a("div",ws,[e[22]||(e[22]=s("h3",{class:"text-lg font-semibold text-brown-dark dark:text-brown-dark mb-4"},"ملفات وكتب مرتبطة:",-1)),s("div",bs,[(o(!0),a(Pe,null,Ee(A.value,n=>(o(),a("div",{key:n.id},[n.storage_path?(o(),a("button",{key:0,onClick:k=>me(n.storage_path,n.title),class:"button-secondary inline-flex items-center gap-2 text-sm"},[e[20]||(e[20]=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm4.75 8.75a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 .75-.75Z","clip-rule":"evenodd"}),s("path",{"fill-rule":"evenodd",d:"M9 3.5a.5.5 0 0 0-.5.5v2.75A1.75 1.75 0 0 0 10.25 8.5h2.75a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 0-.5-.5h-3ZM11 5.75v1.75a.25.25 0 0 0 .25.25h1.75a.25.25 0 0 0 .25-.25V5.75H11Z","clip-rule":"evenodd"})],-1)),s("span",null,[L("عرض: "+g(n.title)+" ",1),s("span",Cs,"("+g(ge(n))+")",1)])],8,ks)):(o(),a("span",$s,[e[21]||(e[21]=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4 opacity-50","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM8.28 7.22a.75.75 0 0 0-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 1 0 1.06 1.06L10 11.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L11.06 10l1.72-1.72a.75.75 0 0 0-1.06-1.06L10 8.94 8.28 7.22Z","clip-rule":"evenodd"})],-1)),s("span",null,g(n.title)+" (لا يوجد ملف مرفق)",1)]))]))),128))])])):$("",!0),m(r,null,{fallback:c(()=>e[23]||(e[23]=[s("div",{class:"pt-6 border-t border-gray-200 dark:border-gray-700"},[s("div",{class:"h-8 w-32 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-4"}),s("div",{class:"h-20 bg-gray-100 dark:bg-gray-800 rounded animate-pulse"})],-1)])),default:c(()=>{var n;return[(n=d.value)!=null&&n.id?(o(),ee(Se,{key:0,"lesson-id":d.value.id,class:"pt-6 border-t border-gray-200 dark:border-gray-700"},null,8,["lesson-id"])):$("",!0)]}),_:1})])),m(r,null,{fallback:c(()=>e[24]||(e[24]=[s("div",null,null,-1)])),default:c(()=>[m(x(ne),{show:G.value,"storage-path":W.value,"book-title":X.value,onClose:pe},null,8,["show","storage-path","book-title"])]),_:1})])}}}),Ns=Ze(Ls,[["__scopeId","data-v-847b3f55"]]);export{Ns as default};
