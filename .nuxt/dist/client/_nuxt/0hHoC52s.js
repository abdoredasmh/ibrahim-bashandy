import{e as T,u as U,r as y,g as q,l as I,p as D,o as x,w as f,b as v,a as t,h as g,d as N,t as h,v as Y,c as S,i as w,x as V,a6 as F,y as L}from"./CaF1xe-H.js";import{L as z}from"./CpjGp_h0.js";import{t as O,c as _}from"./DhpZqJBn.js";import{h as C,G as E,V as G,Y as W,S as A}from"./vWwLff75.js";function M(r,n,d){const s=O(r);return isNaN(n)?_(r,NaN):(n&&s.setDate(s.getDate()+n),s)}function H(r,n,d){const s=O(r);if(isNaN(n))return _(r,NaN);const b=s.getDate(),l=_(r,s.getTime());l.setMonth(s.getMonth()+n+1,0);const c=l.getDate();return b>=c?l:(s.setFullYear(l.getFullYear(),l.getMonth(),b),s)}function J(r,n,d){return M(r,n*7)}const K={class:"fixed inset-0 overflow-y-auto"},P={class:"flex min-h-full items-center justify-center p-4 text-center"},Q={class:"mt-4 space-y-4"},R={key:0},X=["min"],Z={key:1,class:"text-sm text-red-600 dark:text-red-400"},$={class:"mt-6 flex justify-start gap-3"},ee=["disabled"],te=["disabled"],ne=T({__name:"SuspendCommentModal",props:{user:{type:Object,required:!0},modelValue:{type:Boolean,default:!1}},emits:["close","suspended","update:modelValue"],setup(r,{emit:n}){const d=r,s=n,b=U(),l=y(d.modelValue),c=y("1_day"),m=y(""),i=y(!1),u=y(null),j=q(()=>{const a=new Date;return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a.toISOString().slice(0,16)});I(()=>d.modelValue,a=>{l.value=a,a&&(c.value="1_day",m.value="",u.value=null,i.value=!1)});function k(){i.value||(l.value=!1,s("update:modelValue",!1),s("close"))}async function B(){if(!d.user||i.value)return;let a=null;const e=new Date;try{switch(c.value){case"1_day":a=M(e,1);break;case"3_days":a=M(e,3);break;case"1_week":a=J(e,1);break;case"1_month":a=H(e,1);break;case"custom":if(!m.value){u.value="الرجاء تحديد تاريخ انتهاء الإيقاف.";return}if(a=new Date(m.value),isNaN(a.getTime())||a<=e){u.value="تاريخ الانتهاء يجب أن يكون في المستقبل.";return}break;default:u.value="مدة إيقاف غير صالحة.";return}}catch{u.value="تنسيق التاريخ غير صالح.";return}i.value=!0,u.value=null;try{const o=a.toISOString(),{error:p}=await b.from("profiles").update({comment_suspended_until:o}).eq("id",d.user.id);if(p)throw p;s("suspended",d.user.id,!0,o),k()}catch(o){console.error("Error suspending comments:",o),u.value=o.message||"فشل إيقاف تعليقات المستخدم."}finally{i.value=!1}}return(a,e)=>(x(),D(g(A),{appear:"",show:l.value,as:"template"},{default:f(()=>[v(g(W),{as:"div",onClose:k,class:"relative z-40"},{default:f(()=>[v(g(C),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>e[2]||(e[2]=[t("div",{class:"fixed inset-0 bg-black/30 backdrop-blur-sm"},null,-1)])),_:1}),t("div",K,[t("div",P,[v(g(C),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:f(()=>[v(g(E),{class:"w-full max-w-lg transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 p-6 text-right shadow-xl transition-all"},{default:f(()=>[v(g(G),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-gray-100 mb-4 border-b dark:border-gray-700 pb-3"},{default:f(()=>{var o,p;return[N(" إيقاف التعليقات للمستخدم: "+h(((o=r.user)==null?void 0:o.full_name)||((p=r.user)==null?void 0:p.auth_email)),1)]}),_:1}),t("form",{onSubmit:Y(B,["prevent"])},[t("div",Q,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," حدد مدة إيقاف المستخدم عن إضافة تعليقات جديدة. سيتمكن من التعليق مرة أخرى بعد انتهاء المدة. ",-1)),t("div",null,[e[4]||(e[4]=t("label",{for:"suspension-duration",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"مدة الإيقاف *",-1)),V(t("select",{id:"suspension-duration","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white"},e[3]||(e[3]=[t("option",{value:"1_day"},"يوم واحد",-1),t("option",{value:"3_days"},"3 أيام",-1),t("option",{value:"1_week"},"أسبوع واحد",-1),t("option",{value:"1_month"},"شهر واحد",-1),t("option",{value:"custom"},"مدة مخصصة (تاريخ الانتهاء)",-1)]),512),[[F,c.value]])]),c.value==="custom"?(x(),S("div",R,[e[5]||(e[5]=t("label",{for:"suspension-until",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"تاريخ انتهاء الإيقاف *",-1)),V(t("input",{type:"datetime-local",id:"suspension-until","onUpdate:modelValue":e[1]||(e[1]=o=>m.value=o),required:"",min:j.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,8,X),[[L,m.value]])])):w("",!0),u.value?(x(),S("p",Z,h(u.value),1)):w("",!0)]),t("div",$,[t("button",{type:"submit",disabled:i.value||c.value==="custom"&&!m.value,class:"inline-flex justify-center rounded-md border border-transparent bg-yellow-600 px-6 py-2 text-sm font-medium text-white shadow-sm hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50"},[i.value?(x(),D(z,{key:0,class:"w-5 h-5 text-white -ml-1 mr-2"})):w("",!0),N(" "+h(i.value?"جارٍ الإيقاف...":"إيقاف التعليقات"),1)],8,ee),t("button",{type:"button",class:"inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:k,disabled:i.value}," إلغاء ",8,te)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}});export{ne as default};
